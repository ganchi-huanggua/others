(lhz-torch-2.0) lhz@csgpu-SYS-4029GP-TRT:~/code/LAMDA-PILOT$ python main.py --config=./exps/l2p_self_training.json
2023-12-20 19:32:13,497 [trainer.py] => config: ./exps/l2p_self_training.json
2023-12-20 19:32:13,497 [trainer.py] => prefix:  
2023-12-20 19:32:13,497 [trainer.py] => dataset: cifar224
2023-12-20 19:32:13,497 [trainer.py] => memory_size: 0
2023-12-20 19:32:13,498 [trainer.py] => memory_per_class: 0
2023-12-20 19:32:13,498 [trainer.py] => fixed_memory: False
2023-12-20 19:32:13,498 [trainer.py] => shuffle: True
2023-12-20 19:32:13,498 [trainer.py] => init_cls: 10
2023-12-20 19:32:13,498 [trainer.py] => increment: 10
2023-12-20 19:32:13,498 [trainer.py] => model_name: l2p_self_training
2023-12-20 19:32:13,498 [trainer.py] => backbone_type: vit_base_patch16_224_l2p
2023-12-20 19:32:13,498 [trainer.py] => get_original_backbone: True
2023-12-20 19:32:13,498 [trainer.py] => device: [device(type='cuda', index=5)]
2023-12-20 19:32:13,498 [trainer.py] => seed: 1993
2023-12-20 19:32:13,498 [trainer.py] => tuned_epoch: 5
2023-12-20 19:32:13,498 [trainer.py] => init_lr: 0.001875
2023-12-20 19:32:13,498 [trainer.py] => batch_size: 16
2023-12-20 19:32:13,498 [trainer.py] => weight_decay: 0
2023-12-20 19:32:13,498 [trainer.py] => min_lr: 1e-05
2023-12-20 19:32:13,498 [trainer.py] => optimizer: adam
2023-12-20 19:32:13,498 [trainer.py] => scheduler: constant
2023-12-20 19:32:13,498 [trainer.py] => reinit_optimizer: True
2023-12-20 19:32:13,498 [trainer.py] => global_pool: token
2023-12-20 19:32:13,498 [trainer.py] => head_type: prompt
2023-12-20 19:32:13,498 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2023-12-20 19:32:13,498 [trainer.py] => pretrained: True
2023-12-20 19:32:13,498 [trainer.py] => drop: 0.0
2023-12-20 19:32:13,498 [trainer.py] => drop_path: 0.0
2023-12-20 19:32:13,498 [trainer.py] => prompt_pool: True
2023-12-20 19:32:13,498 [trainer.py] => pool_size: 10
2023-12-20 19:32:13,498 [trainer.py] => length: 5
2023-12-20 19:32:13,499 [trainer.py] => top_k: 5
2023-12-20 19:32:13,499 [trainer.py] => initializer: uniform
2023-12-20 19:32:13,499 [trainer.py] => prompt_key: True
2023-12-20 19:32:13,499 [trainer.py] => prompt_key_init: uniform
2023-12-20 19:32:13,499 [trainer.py] => use_prompt_mask: False
2023-12-20 19:32:13,499 [trainer.py] => shared_prompt_pool: False
2023-12-20 19:32:13,499 [trainer.py] => shared_prompt_key: False
2023-12-20 19:32:13,499 [trainer.py] => batchwise_prompt: True
2023-12-20 19:32:13,499 [trainer.py] => embedding_key: cls
2023-12-20 19:32:13,499 [trainer.py] => predefined_key: 
2023-12-20 19:32:13,499 [trainer.py] => pull_constraint: True
2023-12-20 19:32:13,499 [trainer.py] => pull_constraint_coeff: 0.1
2023-12-20 19:32:13,499 [trainer.py] => semi_supervised_mode: True
2023-12-20 19:32:13,499 [trainer.py] => labeled_ratio: 0.05
2023-12-20 19:32:13,499 [trainer.py] => unlabeled_data_distribution_mode: no_ood
2023-12-20 19:32:13,499 [trainer.py] => confidence_threshold: 0.9
2023-12-20 19:32:13,499 [trainer.py] => seeing_once: False
Files already downloaded and verified
Files already downloaded and verified
2023-12-20 19:32:15,543 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2023-12-20 19:32:17,975 [vision_transformer_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2023-12-20 19:32:17,976 [vision_transformer_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2023-12-20 19:32:21,250 [l2p_self_training.py] => 85,940,836 model total parameters.
2023-12-20 19:32:21,252 [l2p_self_training.py] => 122,980 model training parameters.
2023-12-20 19:32:21,252 [l2p_self_training.py] => prompt.prompt: 38400
2023-12-20 19:32:21,252 [l2p_self_training.py] => prompt.prompt_key: 7680
2023-12-20 19:32:21,252 [l2p_self_training.py] => head.weight: 76800
2023-12-20 19:32:21,252 [l2p_self_training.py] => head.bias: 100
2023-12-20 19:32:21,254 [trainer.py] => All params: 171816392
2023-12-20 19:32:21,256 [trainer.py] => Trainable params: 122980
2023-12-20 19:32:21,256 [l2p_self_training.py] => Learning on 0-10
  0%|                                                                                                                                                                               | 0/5 [00:00<?, ?it/s]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.6976443   0.11586694  0.4953246  ...  0.28749058 -0.18747355
   -0.04166955]
  [-0.7704555  -0.5645663   0.20405331 ... -0.9181629   0.84346724
    0.25934926]
  [-0.72331834  0.933808   -0.8247606  ...  0.31124556  0.6839882
    0.86295307]
  [ 0.18564448  0.01180884  0.739691   ... -0.39184847 -0.01054851
    0.4904621 ]
  [ 0.7496169  -0.97091454 -0.23167863 ...  0.34982046 -0.45866644
   -0.12811561]]

 [[-0.08306085  0.06784622 -0.31234756 ...  0.08240896 -0.23737936
    0.80278087]
  [ 0.9946478  -0.94965947 -0.83310056 ...  0.9072631  -0.09802521
   -0.9228176 ]
  [-0.5013145  -0.45180723 -0.7452827  ... -0.659878   -0.39019868
   -0.0335014 ]
  [ 0.74010956 -0.33018327  0.445904   ... -0.10657251 -0.36358905
   -0.01236196]
  [ 0.84030634 -0.47573465 -0.9700343  ... -0.05480204 -0.08109155
   -0.3909573 ]]

 [[-0.1977039  -0.00548246  0.8539734  ... -0.34483406 -1.0056193
    0.87137145]
  [-0.47322515  0.8109376   0.3813014  ...  0.92950594  0.3152927
    0.04454736]
  [-0.622537   -0.22488217 -0.30632305 ...  0.7283592  -0.8296979
    0.83632004]
  [ 0.42681694 -0.9317378  -0.6759295  ... -0.7100909  -0.54872084
   -0.7062577 ]
  [ 0.87031543 -0.40355316  0.4295647  ... -0.9353746  -0.96810615
   -0.97158474]]

 ...

 [[-0.76809204 -0.2521551  -0.82486796 ...  0.498264   -0.9441542
    0.07943606]
  [ 0.8496743   0.3310617  -0.83338284 ... -0.10506004 -0.46591812
   -0.6258735 ]
  [-0.21878083 -0.58993614  0.22266072 ... -0.939756    0.35621578
   -0.7833654 ]
  [ 0.8005687   0.39867127 -0.8197442  ... -0.84716815  0.5836273
    0.6987268 ]
  [ 0.8767162   0.10386586  0.8064689  ...  0.00495459 -0.36314186
    1.0047011 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.33622268  0.31949368  0.06473333 ...  0.56425625  0.6205246
    0.46750826]
  [ 0.8695452   0.14039399 -0.38259834 ...  0.7958166   0.5206404
   -0.75433236]
  [-0.35240903 -0.84053016 -0.5961032  ...  0.8841539  -0.1108389
    0.06730229]
  [ 0.40315345  0.23612    -0.71086645 ... -0.03190893 -0.45553723
   -0.01194494]
  [-0.86513287 -0.5992161  -0.92949164 ... -0.8295951   0.967651
   -0.42007837]]]
Task 0, Epoch 1/5, Self_training_Iteration: 0 => Loss 2.120, Train_accy 29.20:  20%|█████████████████▌                                                                      | 1/5 [00:03<00:12,  3.16s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.6916981   0.11619767  0.508061   ...  0.28752458 -0.19010764
   -0.04321609]
  [-0.7631882  -0.5585536   0.2067645  ... -0.9134483   0.84006643
    0.2538453 ]
  [-0.7198038   0.9363746  -0.823026   ...  0.32500303  0.68998235
    0.8636495 ]
  [ 0.19824204  0.0306791   0.75662595 ... -0.37927893  0.00483754
    0.4957536 ]
  [ 0.74907696 -0.9629375  -0.2174533  ...  0.3481031  -0.4552872
   -0.11589516]]

 [[-0.08077435  0.06797961 -0.2947808  ...  0.07635865 -0.22174235
    0.8116706 ]
  [ 0.99547505 -0.93784934 -0.8245883  ...  0.91212386 -0.09448408
   -0.919535  ]
  [-0.5009329  -0.43973807 -0.7406792  ... -0.6585106  -0.37658665
   -0.031595  ]
  [ 0.75408334 -0.31372344  0.45854795 ... -0.10456821 -0.35874477
   -0.01846165]
  [ 0.8398107  -0.47377956 -0.9531323  ... -0.04427637 -0.08629338
   -0.38703045]]

 [[-0.19997345 -0.00321289  0.85624254 ... -0.34710267 -1.0078888
    0.87364084]
  [-0.47549444  0.8086682   0.383571   ...  0.931775    0.31756163
    0.0422778 ]
  [-0.6248064  -0.2226126  -0.30405354 ...  0.73062867 -0.8274284
    0.83405066]
  [ 0.42454764 -0.9340072  -0.6781989  ... -0.7078215  -0.5464514
   -0.7085271 ]
  [ 0.8725848  -0.40582272  0.4318343  ... -0.93310535 -0.97037554
   -0.9693153 ]]

 ...

 [[-0.7633003  -0.2536094  -0.817728   ...  0.5036753  -0.94089735
    0.07377255]
  [ 0.85435104  0.3485149  -0.8228302  ... -0.11165883 -0.4548158
   -0.63426125]
  [-0.21820927 -0.5711574   0.21891293 ... -0.94010097  0.3636045
   -0.7705126 ]
  [ 0.7948371   0.39764264 -0.8082275  ... -0.86253375  0.58345133
    0.7077536 ]
  [ 0.87571275  0.11705923  0.81335086 ...  0.00823428 -0.35550824
    1.0124973 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.33029604  0.30130646  0.05521231 ...  0.55349475  0.60892856
    0.46559516]
  [ 0.8840142   0.1414978  -0.3739888  ...  0.7959115   0.5128544
   -0.74810696]
  [-0.3418136  -0.8377729  -0.59373266 ...  0.88829577 -0.12967442
    0.06391984]
  [ 0.39702135  0.23525925 -0.7080668  ... -0.02486073 -0.45024034
   -0.01325383]
  [-0.8608891  -0.5863404  -0.9126527  ... -0.8330515   0.96114784
   -0.4081039 ]]]
Task 0, Epoch 2/5, Self_training_Iteration: 0 => Loss 0.974, Train_accy 67.20:  40%|███████████████████████████████████▏                                                    | 2/5 [00:05<00:08,  2.85s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.68670684  0.11594733  0.51616234 ...  0.28357577 -0.19730677
   -0.04616253]
  [-0.7504772  -0.5540752   0.21920659 ... -0.91137874  0.83923376
    0.24755265]
  [-0.70877266  0.93793476 -0.82544786 ...  0.33342585  0.6947846
    0.86261314]
  [ 0.2078212   0.04389983  0.77240914 ... -0.36990938  0.01734504
    0.4903077 ]
  [ 0.7511781  -0.95841473 -0.20678982 ...  0.3480197  -0.44586143
   -0.10990368]]

 [[-0.07755664  0.06739882 -0.2835355  ...  0.07818251 -0.21081834
    0.8144414 ]
  [ 1.0046172  -0.9321386  -0.8232819  ...  0.9186339  -0.09678204
   -0.9192459 ]
  [-0.4937139  -0.431543   -0.7343608  ... -0.65696377 -0.36142787
   -0.03205389]
  [ 0.7620631  -0.29919046  0.46304476 ... -0.09540474 -0.35662487
   -0.02863622]
  [ 0.84810495 -0.4685164  -0.9395442  ... -0.03621746 -0.09182451
   -0.39002696]]

 [[-0.2004811  -0.00270522  0.85675013 ... -0.34761012 -1.0083965
    0.87414855]
  [-0.47600204  0.8081605   0.38407868 ...  0.9322824   0.3180691
    0.04177013]
  [-0.6253142  -0.22210495 -0.30354592 ...  0.73113644 -0.8269206
    0.8335429 ]
  [ 0.42404005 -0.934515   -0.67870665 ... -0.7073137  -0.5459436
   -0.70903486]
  [ 0.8730925  -0.40633038  0.432342   ... -0.9325977  -0.9708833
   -0.9688075 ]]

 ...

 [[-0.75232214 -0.2568782  -0.81277996 ...  0.50818664 -0.93756187
    0.06766695]
  [ 0.8591776   0.3529391  -0.81259686 ... -0.11928747 -0.45515662
   -0.6391229 ]
  [-0.21722639 -0.567204    0.22001469 ... -0.9409378   0.3686653
   -0.7627431 ]
  [ 0.8036024   0.39624202 -0.80239224 ... -0.86440694  0.5747097
    0.71174425]
  [ 0.8814553   0.12793006  0.8192098  ...  0.01379331 -0.35025397
    1.0161747 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.3330002   0.29446512  0.05689828 ...  0.5439664   0.60328686
    0.46308175]
  [ 0.89675856  0.14828825 -0.37355468 ...  0.80099493  0.5080644
   -0.74074453]
  [-0.33452106 -0.83614135 -0.5931373  ...  0.8898949  -0.13717574
    0.05693285]
  [ 0.40198     0.23352647 -0.700718   ... -0.01896349 -0.45858297
   -0.01834328]
  [-0.8521229  -0.57078135 -0.9024957  ... -0.83347344  0.9596178
   -0.4077736 ]]]
Task 0, Epoch 3/5, Self_training_Iteration: 0 => Loss 0.736, Train_accy 76.00:  60%|████████████████████████████████████████████████████▊                                   | 3/5 [00:08<00:05,  2.74s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.68468446  0.11318112  0.5245547  ...  0.2832277  -0.20577867
   -0.04317406]
  [-0.74569553 -0.54972947  0.22312249 ... -0.9090726   0.83922046
    0.24000968]
  [-0.70531297  0.9429064  -0.82298166 ...  0.3399617   0.6915104
    0.8635387 ]
  [ 0.21694721  0.05338124  0.78391147 ... -0.36552808  0.02516707
    0.49009353]
  [ 0.75106615 -0.9552101  -0.19521214 ...  0.34304002 -0.43188944
   -0.10650212]]

 [[-0.081436    0.06654086 -0.27341285 ...  0.07564281 -0.20713528
    0.8183481 ]
  [ 1.0079852  -0.92412734 -0.8196999  ...  0.92543083 -0.09985776
   -0.91798395]
  [-0.49019912 -0.42643476 -0.73090655 ... -0.65997124 -0.34994936
   -0.03399765]
  [ 0.7631346  -0.28821754  0.46774065 ... -0.09295858 -0.35517952
   -0.02926017]
  [ 0.85091794 -0.46412146 -0.92777544 ... -0.02841583 -0.09898024
   -0.38550323]]

 [[-0.20059189 -0.00259444  0.8568609  ... -0.3477208  -1.0085073
    0.8742593 ]
  [-0.47611284  0.80804974  0.3841895  ...  0.93239313  0.31817985
    0.04165935]
  [-0.6254249  -0.22199416 -0.30343512 ...  0.7312472  -0.8268099
    0.83343214]
  [ 0.42392924 -0.93462574 -0.6788174  ... -0.707203   -0.5458329
   -0.7091456 ]
  [ 0.8732032  -0.40644118  0.4324528  ... -0.93248695 -0.97099406
   -0.9686968 ]]

 ...

 [[-0.74352264 -0.25951675 -0.80688596 ...  0.5094861  -0.93688554
    0.06411722]
  [ 0.86198455  0.35945818 -0.8042169  ... -0.12511258 -0.4541601
   -0.64288515]
  [-0.21174526 -0.5620097   0.22396836 ... -0.94346535  0.37203225
   -0.7548004 ]
  [ 0.80729944  0.40031242 -0.7950022  ... -0.8706419   0.56973475
    0.709781  ]
  [ 0.8808196   0.13822557  0.8205692  ...  0.02002651 -0.34558442
    1.0178423 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.3300731   0.28780437  0.0565323  ...  0.54046774  0.6033643
    0.46263894]
  [ 0.904519    0.14755993 -0.37119782 ...  0.802134    0.5074097
   -0.73210686]
  [-0.32960722 -0.83088666 -0.5897915  ...  0.89285225 -0.14599216
    0.05863079]
  [ 0.40375388  0.23472354 -0.6950835  ... -0.01671968 -0.46433783
   -0.01674501]
  [-0.8506132  -0.5586772  -0.8897696  ... -0.83335847  0.9591798
   -0.40766487]]]
Task 0, Epoch 4/5, Self_training_Iteration: 0 => Loss 0.549, Train_accy 84.00:  80%|██████████████████████████████████████████████████████████████████████▍                 | 4/5 [00:11<00:02,  2.72s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.68244255  0.11347076  0.5355157  ...  0.28583083 -0.20151928
   -0.04218197]
  [-0.74194956 -0.54149306  0.23099186 ... -0.9086927   0.836455
    0.23664491]
  [-0.7051174   0.9420561  -0.82307446 ...  0.3478452   0.69268817
    0.86038184]
  [ 0.2226109   0.06771488  0.79688996 ... -0.36103076  0.03217335
    0.49258178]
  [ 0.75025034 -0.9444232  -0.18739863 ...  0.3372456  -0.42744532
   -0.10610404]]

 [[-0.09182859  0.07257239 -0.26942962 ...  0.07008142 -0.19969246
    0.8199217 ]
  [ 1.0121173  -0.9155987  -0.812664   ...  0.9405695  -0.10743235
   -0.91993374]
  [-0.49020764 -0.42570674 -0.7284616  ... -0.6577052  -0.34384042
   -0.03800141]
  [ 0.76766175 -0.2795572   0.47345042 ... -0.08720852 -0.35557857
   -0.03845233]
  [ 0.85360104 -0.46058312 -0.91772205 ... -0.02650158 -0.10194042
   -0.38633686]]

 [[-0.20061529 -0.00257105  0.85688424 ... -0.34774414 -1.0085307
    0.87428266]
  [-0.47613624  0.8080264   0.38421288 ...  0.93241644  0.3182032
    0.04163596]
  [-0.6254483  -0.22197077 -0.30341172 ...  0.73127055 -0.8267865
    0.8334088 ]
  [ 0.42390585 -0.9346491  -0.67884076 ... -0.7071796  -0.5458095
   -0.709169  ]
  [ 0.8732266  -0.40646458  0.4324762  ... -0.9324636  -0.9710174
   -0.9686734 ]]

 ...

 [[-0.74014354 -0.26459852 -0.79690087 ...  0.50801814 -0.93159175
    0.0639935 ]
  [ 0.8612197   0.36958104 -0.79380774 ... -0.13089941 -0.4515139
   -0.65113324]
  [-0.21384665 -0.5540758   0.22747278 ... -0.9426105   0.36926016
   -0.74800533]
  [ 0.80916435  0.40625787 -0.79368055 ... -0.87845093  0.5615968
    0.7103734 ]
  [ 0.8794061   0.14282638  0.8220182  ...  0.02482421 -0.3468591
    1.0165052 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.3224785   0.27967516  0.05557048 ...  0.53440493  0.59301317
    0.45610908]
  [ 0.91691864  0.1512806  -0.36719495 ...  0.8089931   0.50576603
   -0.72342014]
  [-0.32099864 -0.8291753  -0.5873832  ...  0.8985927  -0.1524511
    0.05819988]
  [ 0.4094762   0.22925979 -0.69101316 ... -0.01425271 -0.46872565
   -0.0234195 ]
  [-0.8437486  -0.55263484 -0.8753634  ... -0.8370181   0.9679702
   -0.4101399 ]]]
tensor([8, 6, 2, 3, 3, 9, 2, 8, 1, 4, 4, 0, 6, 4, 4, 7], device='cuda:5')
tensor([9, 7, 4, 7, 2, 4, 9, 6, 2, 5, 3, 7, 5, 0, 8, 0], device='cuda:5')
tensor([2, 6, 3, 6, 6, 0, 0, 8, 5, 3, 8, 5, 2, 5, 9, 0], device='cuda:5')
tensor([5, 5, 3, 3, 1, 4, 0, 4, 3, 7, 6, 9, 6, 3, 0, 3], device='cuda:5')
tensor([1, 9, 5, 2, 5, 1, 7, 0, 0, 9, 3, 3, 5, 7, 5, 1], device='cuda:5')
Task 0, Epoch 5/5, Self_training_Iteration: 0 => Loss 0.500, Train_accy 82.40, Test_accy 89.40: 100%|███████████████████████████████████████████████████████████████████████| 5/5 [00:20<00:00,  4.01s/it]
2023-12-20 19:32:42,058 [l2p_self_training.py] => Task 0, Epoch 5/5, Self_training_Iteration: 0 => Loss 0.500, Train_accy 82.40, Test_accy 89.40
2023-12-20 19:32:42,060 [l2p_self_training.py] => Here are still 4758 unlabeled samples left
2023-12-20 19:32:42,060 [l2p_self_training.py] => pseudo labeling start
2023-12-20 19:33:09,690 [l2p_self_training.py] => 1885 unlabeled samples will be pseudo labeled
2023-12-20 19:33:09,691 [l2p_self_training.py] => pseudo labeling finish
Pseudo Accuracy:  0.9915119363395225
  0%|                                                                                                                                                                               | 0/5 [00:00<?, ?it/s]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.71013755  0.0819037   0.5470065  ...  0.3042363  -0.21453474
   -0.02480148]
  [-0.70433533 -0.49258807  0.28361702 ... -0.88660866  0.8303507
    0.28078416]
  [-0.70498776  0.91759    -0.82540697 ...  0.37225646  0.698626
    0.86616296]
  [ 0.27808538  0.10718947  0.8584808  ... -0.3286749   0.06025574
    0.5068522 ]
  [ 0.7480887  -0.9032229  -0.15334906 ...  0.33549494 -0.4078504
   -0.07551099]]

 [[-0.10538538  0.06684575 -0.22530946 ...  0.04424838 -0.16507933
    0.8627904 ]
  [ 1.0595076  -0.87298864 -0.7680629  ...  0.97474545 -0.12738453
   -0.9131081 ]
  [-0.47020718 -0.39247563 -0.69686776 ... -0.6491498  -0.34099492
   -0.0413511 ]
  [ 0.78348774 -0.24181676  0.51065236 ... -0.08490753 -0.37045297
   -0.04436613]
  [ 0.85755825 -0.40448016 -0.8870417  ... -0.02072477 -0.09135821
   -0.41681486]]

 [[-0.2006213  -0.00256501  0.8568901  ... -0.3477501  -1.0085363
    0.8742885 ]
  [-0.4761422   0.80802053  0.38421884 ...  0.9324223   0.31820917
    0.04162993]
  [-0.6254541  -0.22196475 -0.30340576 ...  0.7312764  -0.8267807
    0.83340293]
  [ 0.4238999  -0.93465495 -0.6788466  ... -0.70717376 -0.54580367
   -0.7091748 ]
  [ 0.8732324  -0.40647054  0.43248215 ... -0.93245775 -0.97102326
   -0.96866757]]

 ...

 [[-0.7547705  -0.2896049  -0.7763408  ...  0.50788605 -0.95107687
    0.04396921]
  [ 0.88447756  0.40839642 -0.73721904 ... -0.11926965 -0.4242887
   -0.64730734]
  [-0.17181075 -0.53366977  0.27049795 ... -0.94908136  0.4043371
   -0.72396207]
  [ 0.8353792   0.39311138 -0.80427146 ... -0.89343     0.5147422
    0.74245983]
  [ 0.8921143   0.19474597  0.82818425 ...  0.02925829 -0.33191127
    1.013986  ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.34859306  0.26062173  0.08920002 ...  0.5101496   0.53123677
    0.4436823 ]
  [ 0.93834174  0.1621988  -0.3035068  ...  0.832801    0.51195467
   -0.71643126]
  [-0.28322217 -0.8178278  -0.56510776 ...  0.9208293  -0.21983095
    0.03968224]
  [ 0.43049425  0.230786   -0.6469799  ...  0.00685323 -0.5084119
   -0.04121741]
  [-0.84217465 -0.50726634 -0.80350035 ... -0.7985712   0.9731542
   -0.40882006]]]
Task 0, Epoch 1/5, Self_training_Iteration: 1 => Loss 0.361, Train_accy 85.71:  20%|█████████████████▌                                                                      | 1/5 [00:19<01:17, 19.49s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.7387141   0.0812667   0.5485122  ...  0.32660952 -0.2145406
   -0.00486844]
  [-0.7138506  -0.44199345  0.3097542  ... -0.872632    0.8281767
    0.27777916]
  [-0.70530707  0.8971123  -0.8030018  ...  0.39906514  0.71346796
    0.85368556]
  [ 0.29060438  0.10669283  0.91639316 ... -0.32996085  0.07788028
    0.5058625 ]
  [ 0.74570465 -0.88718206 -0.13336796 ...  0.3391329  -0.41387215
   -0.06616904]]

 [[-0.09471798  0.0582836  -0.20854044 ...  0.0589337  -0.14977345
    0.8817456 ]
  [ 1.0815578  -0.8427618  -0.7370716  ...  0.97953296 -0.14332765
   -0.9192697 ]
  [-0.47663066 -0.3710061  -0.7107071  ... -0.6419936  -0.35139152
   -0.01627448]
  [ 0.78181946 -0.20332582  0.548651   ... -0.10504984 -0.38347754
   -0.04765176]
  [ 0.8846515  -0.36179137 -0.8478261  ... -0.02046972 -0.08337529
   -0.4627084 ]]

 [[-0.2006213  -0.00256501  0.8568901  ... -0.3477501  -1.0085363
    0.8742885 ]
  [-0.4761422   0.80802053  0.38421884 ...  0.9324223   0.31820917
    0.04162993]
  [-0.6254541  -0.22196475 -0.30340576 ...  0.7312764  -0.8267807
    0.83340293]
  [ 0.4238999  -0.93465495 -0.6788466  ... -0.70717376 -0.54580367
   -0.7091748 ]
  [ 0.8732324  -0.40647054  0.43248215 ... -0.93245775 -0.97102326
   -0.96866757]]

 ...

 [[-0.77408785 -0.27895805 -0.73017126 ...  0.49713355 -0.9537721
    0.04455837]
  [ 0.87690514  0.4232989  -0.696427   ... -0.11738417 -0.4149359
   -0.6565228 ]
  [-0.14897273 -0.52306587  0.29324117 ... -0.93650585  0.40373722
   -0.7104753 ]
  [ 0.839329    0.39296523 -0.7688841  ... -0.92237103  0.48761475
    0.75172824]
  [ 0.8886251   0.22217752  0.8499006  ...  0.03052439 -0.31313014
    1.0175142 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.38808572  0.24082743  0.11048839 ...  0.46642008  0.51430166
    0.45606467]
  [ 0.9680094   0.1678859  -0.27375126 ...  0.8424814   0.5009805
   -0.69004595]
  [-0.26388174 -0.79785204 -0.53776455 ...  0.91066784 -0.25394014
    0.03811446]
  [ 0.43304265  0.23961747 -0.60601103 ...  0.01595449 -0.5171529
   -0.05165244]
  [-0.81213516 -0.49008822 -0.75143546 ... -0.7660194   0.9782251
   -0.40850407]]]
Task 0, Epoch 2/5, Self_training_Iteration: 1 => Loss 0.225, Train_accy 88.24:  40%|███████████████████████████████████▏                                                    | 2/5 [00:39<00:58, 19.63s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 7.59535074e-01  5.48591055e-02  5.56719303e-01 ...  3.39243948e-01
   -2.22583711e-01 -2.08852976e-03]
  [-7.33355224e-01 -4.09676492e-01  3.07494879e-01 ... -8.68423164e-01
    8.24299574e-01  3.15611959e-01]
  [-6.84350491e-01  8.97197664e-01 -7.87034392e-01 ...  4.08028811e-01
    7.02433705e-01  8.42256844e-01]
  [ 3.07168007e-01  1.15728669e-01  9.51245189e-01 ... -3.29773068e-01
    1.00478865e-01  5.06871045e-01]
  [ 7.38082469e-01 -8.66715312e-01 -1.42476305e-01 ...  3.19948435e-01
   -4.12830591e-01 -6.61848113e-02]]

 [[-8.34869295e-02  6.81747794e-02 -2.01987162e-01 ...  7.02291951e-02
   -1.47207916e-01  8.86057615e-01]
  [ 1.11259925e+00 -8.23767960e-01 -7.35291481e-01 ...  9.91164923e-01
   -1.38641402e-01 -9.11552191e-01]
  [-4.66765791e-01 -3.43842059e-01 -7.19244480e-01 ... -6.57844901e-01
   -3.52179646e-01 -1.92395188e-02]
  [ 7.93540657e-01 -2.05918580e-01  5.69601953e-01 ... -1.06279619e-01
   -3.77994210e-01 -5.25423288e-02]
  [ 8.95632744e-01 -3.36107701e-01 -8.51652384e-01 ... -1.58976633e-02
   -9.64394137e-02 -5.08641303e-01]]

 [[-2.00621307e-01 -2.56500999e-03  8.56890082e-01 ... -3.47750098e-01
   -1.00853634e+00  8.74288499e-01]
  [-4.76142198e-01  8.08020532e-01  3.84218842e-01 ...  9.32422280e-01
    3.18209171e-01  4.16299254e-02]
  [-6.25454128e-01 -2.21964747e-01 -3.03405762e-01 ...  7.31276393e-01
   -8.26780677e-01  8.33402932e-01]
  [ 4.23899889e-01 -9.34654951e-01 -6.78846598e-01 ... -7.07173765e-01
   -5.45803666e-01 -7.09174812e-01]
  [ 8.73232424e-01 -4.06470537e-01  4.32482153e-01 ... -9.32457745e-01
   -9.71023262e-01 -9.68667567e-01]]

 ...

 [[-7.81904221e-01 -2.76681006e-01 -7.08508968e-01 ...  5.07709384e-01
   -9.50909972e-01  4.87166867e-02]
  [ 9.13930416e-01  4.22035366e-01 -6.49747431e-01 ... -1.36655301e-01
   -4.14495558e-01 -6.60906196e-01]
  [-1.26359239e-01 -5.14758885e-01  2.91767389e-01 ... -9.44195151e-01
    4.37334806e-01 -6.85972810e-01]
  [ 8.61265719e-01  3.90130579e-01 -7.59747565e-01 ... -9.10525978e-01
    4.77219969e-01  7.85512507e-01]
  [ 8.97307992e-01  2.25104019e-01  8.48872066e-01 ...  4.71228436e-02
   -3.15863788e-01  1.02657795e+00]]

 [[-7.57412076e-01 -5.46979308e-01  2.09424496e-01 ... -5.78448415e-01
    7.37749934e-01  6.31709933e-01]
  [ 5.69277406e-01 -2.32257128e-01 -5.49145222e-01 ... -4.83011246e-01
   -2.79593229e-01 -7.23389149e-01]
  [-3.40880275e-01  6.39051199e-01  5.25569916e-01 ...  2.50323296e-01
    9.76151228e-02  6.72688484e-01]
  [-7.10486293e-01 -4.73253846e-01  6.78409696e-01 ...  7.92690516e-01
    4.57178354e-02  4.64237332e-01]
  [-8.48801255e-01  4.26893711e-01  6.62261367e-01 ... -5.46680331e-01
    4.29805756e-01  8.29540730e-01]]

 [[ 4.13742870e-01  2.21141234e-01  1.15875885e-01 ...  4.63846117e-01
    5.13770878e-01  4.44408566e-01]
  [ 1.00076866e+00  1.73392549e-01 -2.58086145e-01 ...  8.42917025e-01
    4.79396760e-01 -6.97414339e-01]
  [-2.44593427e-01 -7.97639728e-01 -5.16767859e-01 ...  8.97802114e-01
   -2.72155225e-01 -1.25119770e-02]
  [ 4.37674671e-01  2.48319641e-01 -5.87741435e-01 ...  8.87705886e-04
   -5.28787255e-01 -5.54658957e-02]
  [-7.79224932e-01 -4.92841840e-01 -7.26121724e-01 ... -7.57274151e-01
    9.67309535e-01 -4.21501666e-01]]]
Task 0, Epoch 3/5, Self_training_Iteration: 1 => Loss 0.074, Train_accy 90.87:  60%|████████████████████████████████████████████████████▊                                   | 3/5 [00:58<00:39, 19.66s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.7452134   0.0380667   0.58118147 ...  0.3364485  -0.22421867
   -0.00160314]
  [-0.7290344  -0.4017636   0.35979533 ... -0.86912453  0.8296931
    0.29891863]
  [-0.66303253  0.88477266 -0.7610363  ...  0.42753756  0.7098496
    0.81295997]
  [ 0.30946118  0.13685581  0.97769064 ... -0.33540562  0.1006146
    0.51396084]
  [ 0.72728497 -0.84811485 -0.12700243 ...  0.3223575  -0.41684204
   -0.0438267 ]]

 [[-0.090867    0.05534697 -0.18653549 ...  0.06318338 -0.14916117
    0.899026  ]
  [ 1.1127743  -0.8066529  -0.71750194 ...  1.0017906  -0.14956696
   -0.9032779 ]
  [-0.47361195 -0.33310428 -0.6712559  ... -0.65923715 -0.36756325
   -0.00927125]
  [ 0.81610817 -0.16884905  0.6076379  ... -0.10312305 -0.382152
   -0.07929736]
  [ 0.93768597 -0.3027245  -0.84512824 ... -0.02578077 -0.09546393
   -0.53039527]]

 [[-0.2006213  -0.00256501  0.8568901  ... -0.3477501  -1.0085363
    0.8742885 ]
  [-0.4761422   0.80802053  0.38421884 ...  0.9324223   0.31820917
    0.04162993]
  [-0.6254541  -0.22196475 -0.30340576 ...  0.7312764  -0.8267807
    0.83340293]
  [ 0.4238999  -0.93465495 -0.6788466  ... -0.70717376 -0.54580367
   -0.7091748 ]
  [ 0.8732324  -0.40647054  0.43248215 ... -0.93245775 -0.97102326
   -0.96866757]]

 ...

 [[-0.79607    -0.32141337 -0.6593497  ...  0.48858607 -0.96772456
    0.04814879]
  [ 0.9221571   0.43240857 -0.6250873  ... -0.13044691 -0.40133178
   -0.67688936]
  [-0.12246636 -0.50376034  0.31634328 ... -0.9502589   0.44314143
   -0.68089885]
  [ 0.86040026  0.40319306 -0.7176516  ... -0.9342545   0.46982542
    0.7814536 ]
  [ 0.90929234  0.24136975  0.87753916 ...  0.07636248 -0.29953134
    1.0118407 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.42432567  0.22378999  0.11941732 ...  0.4564814   0.4854106
    0.4356983 ]
  [ 1.022917    0.1926212  -0.2543967  ...  0.8394507   0.48307458
   -0.6657856 ]
  [-0.22442064 -0.7690692  -0.47868887 ...  0.8946141  -0.27604598
   -0.06390934]
  [ 0.4407898   0.263225   -0.5510158  ... -0.00315652 -0.53568745
   -0.06937897]
  [-0.77036893 -0.46770802 -0.69881475 ... -0.7515204   0.9396085
   -0.438228  ]]]
Task 0, Epoch 4/5, Self_training_Iteration: 1 => Loss 0.051, Train_accy 90.68:  80%|██████████████████████████████████████████████████████████████████████▍                 | 4/5 [01:18<00:19, 19.68s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 7.42620707e-01  3.22559997e-02  5.79078674e-01 ...  3.54080677e-01
   -2.44244322e-01  1.99028999e-02]
  [-7.09088266e-01 -3.86439145e-01  3.60881776e-01 ... -8.56371462e-01
    8.06607366e-01  3.18745553e-01]
  [-6.48236394e-01  8.83997083e-01 -7.40200520e-01 ...  4.44033504e-01
    7.24219680e-01  7.89729953e-01]
  [ 3.24936956e-01  1.38495564e-01  1.00744390e+00 ... -3.25592995e-01
    1.14804000e-01  5.09073496e-01]
  [ 7.35254049e-01 -8.33768666e-01 -1.25662714e-01 ...  3.14429730e-01
   -3.73613030e-01 -6.18592091e-02]]

 [[-6.40047789e-02  7.03422204e-02 -1.47332996e-01 ...  7.75651187e-02
   -1.72934130e-01  9.05740738e-01]
  [ 1.13934827e+00 -8.03226113e-01 -7.26009905e-01 ...  1.00590634e+00
   -1.51101723e-01 -8.96685898e-01]
  [-4.57993358e-01 -3.34530830e-01 -6.76636755e-01 ... -6.60300255e-01
   -3.82228851e-01 -3.14653851e-04]
  [ 8.24877679e-01 -1.84842482e-01  6.26467705e-01 ... -1.18587874e-01
   -4.08190936e-01 -9.92735028e-02]
  [ 9.49390531e-01 -2.84105808e-01 -8.53915811e-01 ... -3.06122284e-02
   -9.11261514e-02 -5.42788267e-01]]

 [[-2.00621307e-01 -2.56500999e-03  8.56890082e-01 ... -3.47750098e-01
   -1.00853634e+00  8.74288499e-01]
  [-4.76142198e-01  8.08020532e-01  3.84218842e-01 ...  9.32422280e-01
    3.18209171e-01  4.16299254e-02]
  [-6.25454128e-01 -2.21964747e-01 -3.03405762e-01 ...  7.31276393e-01
   -8.26780677e-01  8.33402932e-01]
  [ 4.23899889e-01 -9.34654951e-01 -6.78846598e-01 ... -7.07173765e-01
   -5.45803666e-01 -7.09174812e-01]
  [ 8.73232424e-01 -4.06470537e-01  4.32482153e-01 ... -9.32457745e-01
   -9.71023262e-01 -9.68667567e-01]]

 ...

 [[-7.93455124e-01 -3.18288267e-01 -6.45377994e-01 ...  4.74164516e-01
   -9.45386410e-01  5.00127487e-02]
  [ 9.67296362e-01  4.22441006e-01 -6.01804912e-01 ... -1.23192683e-01
   -4.21001703e-01 -7.00294912e-01]
  [-1.09373748e-01 -4.86547798e-01  3.13468277e-01 ... -9.75137651e-01
    4.84350502e-01 -6.65069580e-01]
  [ 8.76499534e-01  3.73566061e-01 -7.04440296e-01 ... -9.52234924e-01
    4.38045591e-01  7.89655805e-01]
  [ 8.89844775e-01  2.49685511e-01  8.87507379e-01 ...  7.55734295e-02
   -2.91321337e-01  1.01247990e+00]]

 [[-7.57412076e-01 -5.46979308e-01  2.09424496e-01 ... -5.78448415e-01
    7.37749934e-01  6.31709933e-01]
  [ 5.69277406e-01 -2.32257128e-01 -5.49145222e-01 ... -4.83011246e-01
   -2.79593229e-01 -7.23389149e-01]
  [-3.40880275e-01  6.39051199e-01  5.25569916e-01 ...  2.50323296e-01
    9.76151228e-02  6.72688484e-01]
  [-7.10486293e-01 -4.73253846e-01  6.78409696e-01 ...  7.92690516e-01
    4.57178354e-02  4.64237332e-01]
  [-8.48801255e-01  4.26893711e-01  6.62261367e-01 ... -5.46680331e-01
    4.29805756e-01  8.29540730e-01]]

 [[ 4.13192689e-01  2.23473325e-01  1.54276103e-01 ...  4.47985113e-01
    4.65449005e-01  4.40503895e-01]
  [ 9.88607466e-01  1.86757371e-01 -2.39010617e-01 ...  8.15328717e-01
    4.81505841e-01 -6.54389143e-01]
  [-1.94153264e-01 -7.58562386e-01 -4.61662471e-01 ...  8.75744700e-01
   -2.72192299e-01 -1.14900053e-01]
  [ 4.40596312e-01  2.81963021e-01 -5.25046408e-01 ... -2.83230795e-03
   -5.48108578e-01 -7.03655854e-02]
  [-7.73615122e-01 -4.53813642e-01 -6.58885717e-01 ... -7.45710731e-01
    9.42193091e-01 -4.49551970e-01]]]
tensor([1, 9, 9, 0, 6, 7, 3, 5, 9, 6, 5, 1, 7, 0, 4, 3], device='cuda:5')
tensor([1, 0, 0, 2, 7, 0, 2, 2, 4, 9, 6, 0, 7, 4, 8, 6], device='cuda:5')
tensor([3, 0, 0, 9, 8, 1, 4, 3, 8, 2, 2, 4, 0, 8, 9, 6], device='cuda:5')
tensor([5, 8, 6, 4, 6, 8, 6, 3, 2, 6, 4, 2, 0, 3, 7, 7], device='cuda:5')
tensor([0, 0, 4, 9, 8, 5, 7, 5, 4, 7, 5, 5, 3, 7, 3, 5], device='cuda:5')
Task 0, Epoch 5/5, Self_training_Iteration: 1 => Loss 0.016, Train_accy 91.38, Test_accy 93.30: 100%|███████████████████████████████████████████████████████████████████████| 5/5 [01:44<00:00, 20.93s/it]
2023-12-20 19:34:54,356 [l2p_self_training.py] => Task 0, Epoch 5/5, Self_training_Iteration: 1 => Loss 0.016, Train_accy 91.38, Test_accy 93.30
2023-12-20 19:34:54,360 [l2p_self_training.py] => Here are still 2873 unlabeled samples left
2023-12-20 19:34:54,360 [l2p_self_training.py] => pseudo labeling start
2023-12-20 19:35:11,377 [l2p_self_training.py] => 1761 unlabeled samples will be pseudo labeled
2023-12-20 19:35:11,378 [l2p_self_training.py] => pseudo labeling finish
Pseudo Accuracy:  0.9239068710959683
  0%|                                                                                                                                                                               | 0/5 [00:00<?, ?it/s]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.7479245   0.03033956  0.5383184  ...  0.3632701  -0.20667008
   -0.0430802 ]
  [-0.7099919  -0.3562698   0.4002732  ... -0.8510002   0.8162743
    0.31216803]
  [-0.6706415   0.8660478  -0.7185854  ...  0.47575164  0.74208343
    0.7837004 ]
  [ 0.334979    0.14594789  1.1040494  ... -0.3330402   0.10269669
    0.50437385]
  [ 0.7177031  -0.79380083 -0.1118155  ...  0.3643271  -0.36547995
   -0.08911563]]

 [[-0.04577633  0.09510976 -0.10355315 ...  0.11149625 -0.16290122
    0.8524162 ]
  [ 1.1833705  -0.811353   -0.6618659  ...  1.0289284  -0.1688238
   -0.8603649 ]
  [-0.45412222 -0.2759283  -0.7124616  ... -0.6385774  -0.41711897
    0.02779288]
  [ 0.8760843  -0.21585432  0.66677856 ... -0.18171717 -0.4626924
   -0.10960711]
  [ 0.92692584 -0.27298415 -0.82804114 ... -0.11171606 -0.0589096
   -0.5884922 ]]

 [[-0.2006213  -0.00256501  0.8568901  ... -0.3477501  -1.0085363
    0.8742885 ]
  [-0.4761422   0.80802053  0.38421884 ...  0.9324223   0.31820917
    0.04162993]
  [-0.6254541  -0.22196475 -0.30340576 ...  0.7312764  -0.8267807
    0.83340293]
  [ 0.4238999  -0.93465495 -0.6788466  ... -0.70717376 -0.54580367
   -0.7091748 ]
  [ 0.8732324  -0.40647054  0.43248215 ... -0.93245775 -0.97102326
   -0.96866757]]

 ...

 [[-0.8306958  -0.2933806  -0.5989992  ...  0.493598   -0.99389255
    0.03427563]
  [ 0.9868651   0.4464354  -0.5974892  ... -0.12363698 -0.3873279
   -0.6902429 ]
  [-0.0913006  -0.47970718  0.35086182 ... -0.98998535  0.5313818
   -0.6243305 ]
  [ 0.9105627   0.4014315  -0.7091163  ... -0.95987046  0.4813853
    0.7570141 ]
  [ 0.91266036  0.24771969  0.8900746  ...  0.07828153 -0.2820597
    0.9891395 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.4011148   0.19753362  0.19322303 ...  0.39039922  0.41046417
    0.43614367]
  [ 0.99442047  0.1638005  -0.20856468 ...  0.7912161   0.5047526
   -0.6798184 ]
  [-0.2089445  -0.7525667  -0.40460995 ...  0.8592002  -0.27528414
   -0.18914887]
  [ 0.4432209   0.31103858 -0.47285983 ... -0.00752606 -0.46868834
   -0.08256088]
  [-0.7609273  -0.43593344 -0.6351137  ... -0.7255275   0.94152707
   -0.48723912]]]
Task 0, Epoch 1/5, Self_training_Iteration: 2 => Loss 0.201, Train_accy 86.40:  20%|█████████████████▌                                                                      | 1/5 [00:35<02:22, 35.51s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.7334297   0.03692531  0.54668707 ...  0.3332667  -0.24254434
   -0.08713395]
  [-0.74981046 -0.3730501   0.42093349 ... -0.82653284  0.8153356
    0.3139884 ]
  [-0.6307486   0.87060577 -0.70648766 ...  0.4823671   0.74711037
    0.7650267 ]
  [ 0.35098672  0.14902262  1.1158891  ... -0.31634817  0.10998305
    0.54403734]
  [ 0.6509065  -0.7807197  -0.10287253 ...  0.35319933 -0.3942926
   -0.11738271]]

 [[-0.07159461  0.08361144 -0.05632656 ...  0.12840177 -0.18307646
    0.8421102 ]
  [ 1.1711372  -0.81984735 -0.64680094 ...  1.0795091  -0.17342386
   -0.81757253]
  [-0.45837134 -0.2431586  -0.67720944 ... -0.6194727  -0.42739663
    0.08159566]
  [ 0.8638003  -0.22361505  0.6841667  ... -0.18297805 -0.45110565
   -0.13444175]
  [ 0.9428665  -0.22389762 -0.80656886 ... -0.10713294 -0.05387767
   -0.57876104]]

 [[-0.2006213  -0.00256501  0.8568901  ... -0.3477501  -1.0085363
    0.8742885 ]
  [-0.4761422   0.80802053  0.38421884 ...  0.9324223   0.31820917
    0.04162993]
  [-0.6254541  -0.22196475 -0.30340576 ...  0.7312764  -0.8267807
    0.83340293]
  [ 0.4238999  -0.93465495 -0.6788466  ... -0.70717376 -0.54580367
   -0.7091748 ]
  [ 0.8732324  -0.40647054  0.43248215 ... -0.93245775 -0.97102326
   -0.96866757]]

 ...

 [[-0.84926945 -0.2796316  -0.5923222  ...  0.48238257 -0.9802946
    0.054929  ]
  [ 0.9592795   0.45427468 -0.55318266 ... -0.12233687 -0.3768954
   -0.7276773 ]
  [-0.09551837 -0.44161102  0.39922228 ... -0.98392934  0.5849267
   -0.62069696]
  [ 0.90702516  0.39829797 -0.6939242  ... -0.9726936   0.47228724
    0.7225475 ]
  [ 0.85168976  0.28813678  0.87415844 ...  0.08809658 -0.28550887
    0.9963546 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.42498156  0.205965    0.21505854 ...  0.36725283  0.38266608
    0.42880946]
  [ 1.0102788   0.19379477 -0.18699974 ...  0.74199873  0.5063375
   -0.6822487 ]
  [-0.20995395 -0.7404282  -0.36135158 ...  0.8465894  -0.31030133
   -0.2027561 ]
  [ 0.42213908  0.2712275  -0.43780103 ... -0.02211859 -0.46595675
   -0.08077582]
  [-0.76194894 -0.41712967 -0.6048721  ... -0.7319151   0.9526729
   -0.5299581 ]]]
Task 0, Epoch 2/5, Self_training_Iteration: 2 => Loss 0.077, Train_accy 87.99:  40%|███████████████████████████████████▏                                                    | 2/5 [01:11<01:46, 35.58s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.71313316  0.03071878  0.54872185 ...  0.3123798  -0.27245685
   -0.14136982]
  [-0.77648443 -0.34176686  0.4195761  ... -0.8087634   0.80312765
    0.3195173 ]
  [-0.66184545  0.84912705 -0.7011161  ...  0.49882275  0.76649314
    0.73850584]
  [ 0.35239977  0.12954535  1.1556674  ... -0.32749507  0.11706803
    0.54005027]
  [ 0.6741505  -0.7670742  -0.09720206 ...  0.3424127  -0.36959293
   -0.13243027]]

 [[-0.08172552  0.07409173 -0.03538836 ...  0.11682758 -0.17307152
    0.830902  ]
  [ 1.2081083  -0.7931921  -0.62396705 ...  1.1399392  -0.18099914
   -0.7957721 ]
  [-0.47275725 -0.20312512 -0.69909096 ... -0.61019427 -0.4420716
    0.07976314]
  [ 0.90169    -0.22519937  0.72149885 ... -0.15813884 -0.44335216
   -0.18189135]
  [ 0.9669894  -0.22789505 -0.80533355 ... -0.12784608 -0.078087
   -0.5995188 ]]

 [[-0.2006213  -0.00256501  0.8568901  ... -0.3477501  -1.0085363
    0.8742885 ]
  [-0.4761422   0.80802053  0.38421884 ...  0.9324223   0.31820917
    0.04162993]
  [-0.6254541  -0.22196475 -0.30340576 ...  0.7312764  -0.8267807
    0.83340293]
  [ 0.4238999  -0.93465495 -0.6788466  ... -0.70717376 -0.54580367
   -0.7091748 ]
  [ 0.8732324  -0.40647054  0.43248215 ... -0.93245775 -0.97102326
   -0.96866757]]

 ...

 [[-0.8831275  -0.24015024 -0.54994535 ...  0.48277026 -0.988449
    0.04772444]
  [ 1.0187755   0.4787267  -0.5483022  ... -0.09701922 -0.38613948
   -0.7505739 ]
  [-0.07457156 -0.39905414  0.4263236  ... -0.99990624  0.6229018
   -0.6316036 ]
  [ 0.89538515  0.35635322 -0.6737386  ... -0.9727613   0.43662602
    0.6926266 ]
  [ 0.8645455   0.2791514   0.88522077 ...  0.05472872 -0.30168065
    0.9909628 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.40761265  0.18785886  0.26472905 ...  0.33819014  0.4093202
    0.42137516]
  [ 1.0525512   0.21563368 -0.1871589  ...  0.73531526  0.4700611
   -0.67904705]
  [-0.19249734 -0.7483987  -0.33458406 ...  0.8282274  -0.35538784
   -0.24001184]
  [ 0.41688773  0.26446304 -0.37900013 ... -0.02602839 -0.41903162
   -0.07459354]
  [-0.7446151  -0.414149   -0.5843275  ... -0.71799904  0.938933
   -0.5304326 ]]]
Task 0, Epoch 3/5, Self_training_Iteration: 2 => Loss 0.070, Train_accy 88.06:  60%|████████████████████████████████████████████████████▊                                   | 3/5 [01:46<01:11, 35.59s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.7227755   0.01582098  0.55428416 ...  0.29614446 -0.28433833
   -0.1738829 ]
  [-0.7545044  -0.35146964  0.43798494 ... -0.8009539   0.83240855
    0.31123766]
  [-0.6400459   0.8536321  -0.69459695 ...  0.49793747  0.7831863
    0.7587609 ]
  [ 0.35548666  0.1537232   1.194157   ... -0.31122547  0.12091632
    0.55198616]
  [ 0.6748572  -0.767147   -0.07501692 ...  0.37943864 -0.33996198
   -0.13673145]]

 [[-0.09753208  0.1093236   0.0144993  ...  0.1252389  -0.14156449
    0.8168731 ]
  [ 1.187721   -0.80960006 -0.62385553 ...  1.1025009  -0.19684534
   -0.8010656 ]
  [-0.4997399  -0.16711456 -0.6846024  ... -0.5948913  -0.44224676
    0.07820242]
  [ 0.92683107 -0.24038237  0.7593782  ... -0.19680025 -0.42513946
   -0.21798545]
  [ 0.964712   -0.24117008 -0.7388702  ... -0.09428056 -0.04729175
   -0.6075319 ]]

 [[-0.2006213  -0.00256501  0.8568901  ... -0.3477501  -1.0085363
    0.8742885 ]
  [-0.4761422   0.80802053  0.38421884 ...  0.9324223   0.31820917
    0.04162993]
  [-0.6254541  -0.22196475 -0.30340576 ...  0.7312764  -0.8267807
    0.83340293]
  [ 0.4238999  -0.93465495 -0.6788466  ... -0.70717376 -0.54580367
   -0.7091748 ]
  [ 0.8732324  -0.40647054  0.43248215 ... -0.93245775 -0.97102326
   -0.96866757]]

 ...

 [[-0.8878168  -0.21148731 -0.5364761  ...  0.5055708  -0.97618556
    0.05413442]
  [ 1.021621    0.47462365 -0.5862151  ... -0.05424338 -0.4164231
   -0.75664884]
  [-0.07557224 -0.39593554  0.45068875 ... -0.992587    0.65814
   -0.6349756 ]
  [ 0.87920964  0.3471331  -0.68701154 ... -0.9847968   0.444185
    0.6950708 ]
  [ 0.8524226   0.30256963  0.8748413  ...  0.06138888 -0.34355658
    1.0200077 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.40805176  0.19402888  0.28337428 ...  0.34245995  0.41616848
    0.4217037 ]
  [ 1.0440205   0.22171994 -0.201436   ...  0.73817754  0.46218377
   -0.69341046]
  [-0.2080367  -0.76194626 -0.3160512  ...  0.83421683 -0.34306908
   -0.2688151 ]
  [ 0.42414457  0.2594131  -0.35301223 ... -0.01574421 -0.41605106
   -0.06362043]
  [-0.7577302  -0.40719053 -0.5837492  ... -0.68249154  0.9123874
   -0.5369198 ]]]
Task 0, Epoch 4/5, Self_training_Iteration: 2 => Loss 0.022, Train_accy 89.32:  80%|██████████████████████████████████████████████████████████████████████▍                 | 4/5 [02:22<00:35, 35.73s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.7506441   0.01476929  0.5704526  ...  0.26603067 -0.2471824
   -0.22584188]
  [-0.797996   -0.31792486  0.43899378 ... -0.7926552   0.8450244
    0.32270604]
  [-0.61140954  0.8354001  -0.70327914 ...  0.5112075   0.8255928
    0.7521662 ]
  [ 0.32164934  0.17340921  1.181316   ... -0.3156041   0.1479555
    0.5459515 ]
  [ 0.7077287  -0.71895343 -0.07718626 ...  0.38928324 -0.34919617
   -0.13695239]]

 [[-0.08718335  0.11252003  0.04728847 ...  0.10608991 -0.13637407
    0.77670515]
  [ 1.1730659  -0.78423446 -0.6209894  ...  1.1134732  -0.20974691
   -0.7773052 ]
  [-0.4955968  -0.16606054 -0.6906735  ... -0.57330215 -0.4574874
    0.0803341 ]
  [ 0.94498366 -0.23994252  0.79815507 ... -0.19317785 -0.41197523
   -0.25861073]
  [ 0.9674943  -0.25691366 -0.7452925  ... -0.10579155 -0.02586196
   -0.6548295 ]]

 [[-0.2006213  -0.00256501  0.8568901  ... -0.3477501  -1.0085363
    0.8742885 ]
  [-0.4761422   0.80802053  0.38421884 ...  0.9324223   0.31820917
    0.04162993]
  [-0.6254541  -0.22196475 -0.30340576 ...  0.7312764  -0.8267807
    0.83340293]
  [ 0.4238999  -0.93465495 -0.6788466  ... -0.70717376 -0.54580367
   -0.7091748 ]
  [ 0.8732324  -0.40647054  0.43248215 ... -0.93245775 -0.97102326
   -0.96866757]]

 ...

 [[-0.9273532  -0.19783644 -0.54178154 ...  0.5049948  -0.9556728
    0.04140514]
  [ 1.0307307   0.4836432  -0.57346356 ... -0.06267963 -0.42680973
   -0.7934611 ]
  [-0.06723106 -0.3818752   0.45624232 ... -0.98587835  0.67766327
   -0.61208665]
  [ 0.89401656  0.3283498  -0.7080452  ... -0.99634445  0.39213252
    0.65580785]
  [ 0.8423826   0.32828718  0.8804233  ...  0.03031393 -0.35131842
    1.0407037 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.37511006  0.20683563  0.3425463  ...  0.34174252  0.3905046
    0.43035713]
  [ 1.0326939   0.25864044 -0.1973591  ...  0.73611116  0.44842476
   -0.6523829 ]
  [-0.18408443 -0.7873152  -0.29325524 ...  0.8391966  -0.36060262
   -0.28046554]
  [ 0.4399187   0.2627669  -0.31761193 ...  0.00179439 -0.40927485
   -0.07692829]
  [-0.7444114  -0.3946451  -0.5249489  ... -0.64606273  0.8772811
   -0.56470966]]]
tensor([5, 3, 1, 4, 9, 2, 2, 4, 0, 3, 1, 6, 0, 8, 2, 2], device='cuda:5')
tensor([2, 9, 4, 8, 1, 2, 5, 0, 5, 4, 0, 3, 5, 1, 1, 6], device='cuda:5')
tensor([7, 6, 4, 1, 6, 1, 0, 7, 2, 1, 6, 0, 9, 9, 1, 6], device='cuda:5')
tensor([6, 8, 3, 7, 5, 4, 6, 6, 4, 2, 8, 1, 0, 0, 4, 5], device='cuda:5')
tensor([9, 4, 8, 6, 9, 3, 1, 3, 9, 5, 3, 0, 1, 4, 9, 4], device='cuda:5')
Task 0, Epoch 5/5, Self_training_Iteration: 2 => Loss 0.024, Train_accy 89.14, Test_accy 94.00: 100%|███████████████████████████████████████████████████████████████████████| 5/5 [03:04<00:00, 36.94s/it]
2023-12-20 19:38:16,070 [l2p_self_training.py] => Task 0, Epoch 5/5, Self_training_Iteration: 2 => Loss 0.024, Train_accy 89.14, Test_accy 94.00
2023-12-20 19:38:16,074 [l2p_self_training.py] => Here are still 1112 unlabeled samples left
2023-12-20 19:38:16,074 [l2p_self_training.py] => pseudo labeling start
2023-12-20 19:38:23,029 [l2p_self_training.py] => 567 unlabeled samples will be pseudo labeled
2023-12-20 19:38:23,029 [l2p_self_training.py] => pseudo labeling finish
Pseudo Accuracy:  0.8959435626102292
  0%|                                                                                                                                                                               | 0/5 [00:00<?, ?it/s]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.7873312  -0.00705807  0.55278456 ...  0.2650586  -0.27278864
   -0.22648008]
  [-0.80366707 -0.3285975   0.43248942 ... -0.85119873  0.8129691
    0.31083056]
  [-0.5602897   0.8450111  -0.6899314  ...  0.53540283  0.84439296
    0.76385504]
  [ 0.36007723  0.21159236  1.2399774  ... -0.30214703  0.16588244
    0.574328  ]
  [ 0.68635046 -0.71090055 -0.09767512 ...  0.4050443  -0.3442222
   -0.12481032]]

 [[-0.11543758  0.10743631  0.0640321  ...  0.12312336 -0.13066703
    0.7966103 ]
  [ 1.2036053  -0.77721494 -0.57899046 ...  1.1867837  -0.21887071
   -0.7375937 ]
  [-0.50107384 -0.14378756 -0.6941141  ... -0.508835   -0.4517805
    0.06534245]
  [ 0.9655413  -0.23251562  0.8218825  ... -0.21320927 -0.43459505
   -0.28948683]
  [ 0.9727402  -0.26438436 -0.7010426  ... -0.12447163 -0.02066243
   -0.66779625]]

 [[-0.2006213  -0.00256501  0.8568901  ... -0.3477501  -1.0085363
    0.8742885 ]
  [-0.4761422   0.80802053  0.38421884 ...  0.9324223   0.31820917
    0.04162993]
  [-0.6254541  -0.22196475 -0.30340576 ...  0.7312764  -0.8267807
    0.83340293]
  [ 0.4238999  -0.93465495 -0.6788466  ... -0.70717376 -0.54580367
   -0.7091748 ]
  [ 0.8732324  -0.40647054  0.43248215 ... -0.93245775 -0.97102326
   -0.96866757]]

 ...

 [[-0.95535636 -0.18827076 -0.5566281  ...  0.5221923  -0.96688133
    0.07101052]
  [ 1.05686     0.5171079  -0.5476107  ... -0.0801248  -0.4322281
   -0.7950133 ]
  [-0.06806971 -0.36842608  0.46407592 ... -0.9819322   0.70398206
   -0.6084335 ]
  [ 0.8800583   0.317015   -0.7023344  ... -0.9927921   0.42261988
    0.6805872 ]
  [ 0.7855435   0.33253485  0.88733935 ... -0.019249   -0.3663881
    1.0454332 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.3682415   0.19328184  0.3557548  ...  0.34892312  0.37607583
    0.4481595 ]
  [ 1.0870486   0.2501556  -0.17685907 ...  0.73081535  0.41730163
   -0.67942226]
  [-0.15768002 -0.7899963  -0.29157305 ...  0.81988764 -0.38969833
   -0.3207377 ]
  [ 0.42424414  0.2396541  -0.28099886 ... -0.03208178 -0.42045438
   -0.09633105]
  [-0.7698823  -0.42772162 -0.51797557 ... -0.677294    0.9155622
   -0.5612179 ]]]
Task 0, Epoch 1/5, Self_training_Iteration: 3 => Loss 0.047, Train_accy 88.12:  20%|█████████████████▌                                                                      | 1/5 [00:40<02:42, 40.68s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.76890486 -0.02899452  0.56261367 ...  0.26738712 -0.2558949
   -0.25065187]
  [-0.80771524 -0.29143503  0.42576465 ... -0.8494126   0.820132
    0.3219771 ]
  [-0.55866045  0.8224746  -0.65363514 ...  0.51775616  0.8599753
    0.7436084 ]
  [ 0.33866432  0.21062823  1.2588536  ... -0.2978571   0.13792644
    0.5829381 ]
  [ 0.66044027 -0.7022265  -0.08226276 ...  0.41620612 -0.35739306
   -0.13790822]]

 [[-0.12493795  0.05168261  0.06823995 ...  0.11567107 -0.11349533
    0.75925213]
  [ 1.1993309  -0.71243894 -0.5490179  ...  1.1778437  -0.21620919
   -0.747184  ]
  [-0.49452615 -0.13070992 -0.69518405 ... -0.46938762 -0.45209497
    0.0565492 ]
  [ 0.9617756  -0.23447144  0.83044636 ... -0.22582605 -0.45653978
   -0.32683492]
  [ 0.9751175  -0.25232652 -0.70537037 ... -0.13812946  0.01923886
   -0.66710955]]

 [[-0.2006213  -0.00256501  0.8568901  ... -0.3477501  -1.0085363
    0.8742885 ]
  [-0.4761422   0.80802053  0.38421884 ...  0.9324223   0.31820917
    0.04162993]
  [-0.6254541  -0.22196475 -0.30340576 ...  0.7312764  -0.8267807
    0.83340293]
  [ 0.4238999  -0.93465495 -0.6788466  ... -0.70717376 -0.54580367
   -0.7091748 ]
  [ 0.8732324  -0.40647054  0.43248215 ... -0.93245775 -0.97102326
   -0.96866757]]

 ...

 [[-1.0050551  -0.16078499 -0.58299226 ...  0.532919   -0.97689795
    0.08705603]
  [ 1.0747901   0.5223205  -0.5286121  ... -0.10987046 -0.43971685
   -0.8484475 ]
  [-0.08352057 -0.36006677  0.50562704 ... -0.9821808   0.7214944
   -0.6303429 ]
  [ 0.85781294  0.296169   -0.7224812  ... -1.0150468   0.45800862
    0.66395605]
  [ 0.8002346   0.3336235   0.85359913 ...  0.0189326  -0.39862096
    1.0568225 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.39334205  0.21006331  0.36808085 ...  0.3437343   0.35453826
    0.42222723]
  [ 1.0801368   0.2548716  -0.1661149  ...  0.7379431   0.40970382
   -0.6749479 ]
  [-0.17424785 -0.8036144  -0.25889096 ...  0.79943734 -0.38479707
   -0.3305496 ]
  [ 0.4198385   0.26002803 -0.24438247 ... -0.07175806 -0.4001914
   -0.13670766]
  [-0.7759494  -0.4239075  -0.49418584 ... -0.66285557  0.92988735
   -0.57458276]]]
Task 0, Epoch 2/5, Self_training_Iteration: 3 => Loss 0.026, Train_accy 89.18:  40%|███████████████████████████████████▏                                                    | 2/5 [01:21<02:02, 40.83s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.76949024 -0.00367274  0.58118975 ...  0.24267268 -0.27204075
   -0.19497404]
  [-0.8529693  -0.27637464  0.43052113 ... -0.84670097  0.7888655
    0.35687527]
  [-0.5306432   0.81359875 -0.6630974  ...  0.49203187  0.83147204
    0.72454596]
  [ 0.30409282  0.20991254  1.2776521  ... -0.30906996  0.14772508
    0.61308116]
  [ 0.6576173  -0.669856   -0.09857735 ...  0.40070444 -0.3196482
   -0.15466748]]

 [[-0.12585405  0.01421426  0.08487771 ...  0.09508424 -0.1351347
    0.75339156]
  [ 1.1956811  -0.6902864  -0.55109715 ...  1.2075446  -0.20048912
   -0.77467436]
  [-0.50451505 -0.08893607 -0.692513   ... -0.4406606  -0.4571112
    0.06298377]
  [ 0.9658333  -0.23188202  0.8783779  ... -0.22480905 -0.462476
   -0.36773986]
  [ 0.9540095  -0.26399824 -0.7009282  ... -0.11497179  0.00777255
   -0.63423246]]

 [[-0.2006213  -0.00256501  0.8568901  ... -0.3477501  -1.0085363
    0.8742885 ]
  [-0.4761422   0.80802053  0.38421884 ...  0.9324223   0.31820917
    0.04162993]
  [-0.6254541  -0.22196475 -0.30340576 ...  0.7312764  -0.8267807
    0.83340293]
  [ 0.4238999  -0.93465495 -0.6788466  ... -0.70717376 -0.54580367
   -0.7091748 ]
  [ 0.8732324  -0.40647054  0.43248215 ... -0.93245775 -0.97102326
   -0.96866757]]

 ...

 [[-1.0124915  -0.1424282  -0.598717   ...  0.509845   -0.96274495
    0.09495673]
  [ 1.0808108   0.54999423 -0.52324355 ... -0.09516621 -0.44208285
   -0.87900573]
  [-0.09179432 -0.35331675  0.52509403 ... -1.0039809   0.7316739
   -0.61497635]
  [ 0.8632182   0.3041818  -0.74656403 ... -1.0151308   0.4213871
    0.73575085]
  [ 0.82607204  0.30247962  0.86190355 ... -0.01867216 -0.41975105
    1.0626038 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.41055313  0.20967902  0.42291138 ...  0.32722616  0.34665057
    0.42971283]
  [ 1.0858307   0.23992491 -0.12437577 ...  0.7082927   0.40685335
   -0.62330043]
  [-0.14847131 -0.75840604 -0.24703988 ...  0.7390937  -0.36244345
   -0.4008367 ]
  [ 0.42107862  0.24480788 -0.23866023 ... -0.07735849 -0.3910512
   -0.12082101]
  [-0.8012248  -0.41696486 -0.49023342 ... -0.702849    0.909389
   -0.5759285 ]]]
Task 0, Epoch 3/5, Self_training_Iteration: 3 => Loss 0.029, Train_accy 89.04:  60%|████████████████████████████████████████████████████▊                                   | 3/5 [02:02<01:21, 40.78s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.7922236  -0.02369088  0.63499886 ...  0.25441235 -0.26622915
   -0.17835318]
  [-0.8986071  -0.2777792   0.48025814 ... -0.832773    0.80495363
    0.36438853]
  [-0.5076247   0.7996973  -0.65091515 ...  0.4916174   0.8173202
    0.71333355]
  [ 0.2958144   0.20076795  1.2570328  ... -0.3238278   0.1626334
    0.6613191 ]
  [ 0.7116601  -0.68298864 -0.10165195 ...  0.40553176 -0.32600248
   -0.11487036]]

 [[-0.13051824  0.02496918  0.12277846 ...  0.09942656 -0.16512166
    0.72107273]
  [ 1.2079659  -0.7075579  -0.54836714 ...  1.2241073  -0.19199148
   -0.7364042 ]
  [-0.5117673  -0.0483334  -0.7232684  ... -0.40232256 -0.47418067
    0.08701982]
  [ 0.9687761  -0.21214488  0.8973672  ... -0.21042222 -0.4194669
   -0.40679756]
  [ 0.9779921  -0.24521042 -0.72268593 ... -0.10438062  0.01304401
   -0.6180463 ]]

 [[-0.2006213  -0.00256501  0.8568901  ... -0.3477501  -1.0085363
    0.8742885 ]
  [-0.4761422   0.80802053  0.38421884 ...  0.9324223   0.31820917
    0.04162993]
  [-0.6254541  -0.22196475 -0.30340576 ...  0.7312764  -0.8267807
    0.83340293]
  [ 0.4238999  -0.93465495 -0.6788466  ... -0.70717376 -0.54580367
   -0.7091748 ]
  [ 0.8732324  -0.40647054  0.43248215 ... -0.93245775 -0.97102326
   -0.96866757]]

 ...

 [[-1.0423248  -0.12810884 -0.5808502  ...  0.50255203 -0.96000123
    0.10562398]
  [ 1.1033001   0.5810608  -0.5184368  ... -0.09209164 -0.41161093
   -0.9119972 ]
  [-0.07779035 -0.35274246  0.5653565  ... -1.00989     0.76091385
   -0.61812943]
  [ 0.85993284  0.2698853  -0.7658684  ... -1.0533698   0.40848663
    0.72591335]
  [ 0.80105525  0.33352402  0.8963421  ...  0.00370985 -0.41867656
    1.043117  ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.38112104  0.228781    0.5128797  ...  0.29117334  0.30867833
    0.40360874]
  [ 1.1304427   0.22300784 -0.11761218 ...  0.6846987   0.38826042
   -0.62844604]
  [-0.15350327 -0.77618897 -0.22742547 ...  0.73969126 -0.3928097
   -0.40879893]
  [ 0.42396066  0.23734385 -0.20210417 ... -0.0901989  -0.38525024
   -0.10848021]
  [-0.8106584  -0.428415   -0.46301243 ... -0.7226698   0.9173956
   -0.599891  ]]]
Task 0, Epoch 4/5, Self_training_Iteration: 3 => Loss 0.028, Train_accy 89.07:  80%|██████████████████████████████████████████████████████████████████████▍                 | 4/5 [02:43<00:40, 40.80s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.7900694  -0.02238699  0.6386575  ...  0.278712   -0.26513797
   -0.18998168]
  [-0.92215973 -0.267866    0.47131196 ... -0.82522184  0.7697323
    0.38626617]
  [-0.48458028  0.78650266 -0.63806945 ...  0.517228    0.83915126
    0.67871475]
  [ 0.32778737  0.16645505  1.2242894  ... -0.34337303  0.14012176
    0.6589028 ]
  [ 0.6885844  -0.7247169  -0.12210876 ...  0.4214695  -0.3189758
   -0.10751715]]

 [[-0.16733752  0.02149414  0.12103951 ...  0.10754853 -0.15159172
    0.72091305]
  [ 1.1759048  -0.7270019  -0.48358822 ...  1.2155321  -0.22396581
   -0.74833053]
  [-0.5021422  -0.02287588 -0.7547444  ... -0.44752333 -0.46331286
    0.09973919]
  [ 0.94579214 -0.210068    0.8899573  ... -0.19916381 -0.44420862
   -0.4787257 ]
  [ 0.93837446 -0.29925808 -0.7351034  ... -0.14678048  0.04090197
   -0.6151105 ]]

 [[-0.2006213  -0.00256501  0.8568901  ... -0.3477501  -1.0085363
    0.8742885 ]
  [-0.4761422   0.80802053  0.38421884 ...  0.9324223   0.31820917
    0.04162993]
  [-0.6254541  -0.22196475 -0.30340576 ...  0.7312764  -0.8267807
    0.83340293]
  [ 0.4238999  -0.93465495 -0.6788466  ... -0.70717376 -0.54580367
   -0.7091748 ]
  [ 0.8732324  -0.40647054  0.43248215 ... -0.93245775 -0.97102326
   -0.96866757]]

 ...

 [[-1.0659319  -0.12826905 -0.5868534  ...  0.5343886  -0.950431
    0.12852392]
  [ 1.0816214   0.5809015  -0.51883656 ... -0.08752961 -0.41244006
   -0.9540251 ]
  [-0.09522623 -0.34734848  0.56658727 ... -0.98793525  0.7720927
   -0.6209238 ]
  [ 0.8638214   0.26908302 -0.77054954 ... -1.0758717   0.37662175
    0.7032482 ]
  [ 0.8122838   0.31375584  0.86876565 ...  0.00759293 -0.4102802
    1.0372758 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.3504791   0.22603051  0.5189105  ...  0.29860064  0.25976112
    0.42296913]
  [ 1.1265825   0.26438898 -0.05596681 ...  0.7139474   0.42416492
   -0.61029613]
  [-0.14494336 -0.77471375 -0.21446794 ...  0.7242411  -0.40585774
   -0.41712528]
  [ 0.42675745  0.21383965 -0.19715974 ... -0.06700936 -0.3939093
   -0.10272659]
  [-0.79649454 -0.44246638 -0.43301994 ... -0.69283235  0.93037426
   -0.6190831 ]]]
tensor([6, 7, 9, 9, 8, 3, 8, 9, 0, 8, 0, 5, 8, 7, 0, 1], device='cuda:5')
tensor([7, 2, 2, 9, 0, 7, 0, 3, 6, 3, 2, 0, 4, 5, 5, 8], device='cuda:5')
tensor([6, 1, 7, 2, 9, 8, 7, 1, 8, 4, 7, 5, 1, 0, 8, 2], device='cuda:5')
tensor([5, 8, 4, 6, 7, 4, 5, 6, 2, 5, 2, 4, 1, 2, 7, 0], device='cuda:5')
tensor([7, 4, 8, 7, 1, 6, 5, 1, 9, 7, 4, 7, 7, 7, 9, 0], device='cuda:5')
Task 0, Epoch 5/5, Self_training_Iteration: 3 => Loss 0.037, Train_accy 88.80, Test_accy 93.50: 100%|███████████████████████████████████████████████████████████████████████| 5/5 [03:30<00:00, 42.07s/it]
2023-12-20 19:41:53,404 [l2p_self_training.py] => Task 0, Epoch 5/5, Self_training_Iteration: 3 => Loss 0.037, Train_accy 88.80, Test_accy 93.50
2023-12-20 19:41:53,407 [l2p_self_training.py] => Here are still 545 unlabeled samples left
2023-12-20 19:41:53,407 [l2p_self_training.py] => pseudo labeling start
2023-12-20 19:41:57,086 [l2p_self_training.py] => 193 unlabeled samples will be pseudo labeled
2023-12-20 19:41:57,086 [l2p_self_training.py] => pseudo labeling finish
Pseudo Accuracy:  0.8652849740932642
  0%|                                                                                                                                                                               | 0/5 [00:00<?, ?it/s]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.78564173 -0.01129667  0.62823224 ...  0.28237554 -0.25828922
   -0.21895054]
  [-0.9690753  -0.23325922  0.4315006  ... -0.7930437   0.75256467
    0.44659534]
  [-0.45659322  0.7956195  -0.6500204  ...  0.5200523   0.8214487
    0.6948676 ]
  [ 0.3303702   0.1346873   1.2012161  ... -0.3403696   0.13607508
    0.6441217 ]
  [ 0.6680056  -0.6708846  -0.15365796 ...  0.3851525  -0.26388815
   -0.07480605]]

 [[-0.13921641  0.00770925  0.11234841 ...  0.12343129 -0.1617152
    0.6561289 ]
  [ 1.1523544  -0.71176577 -0.44813627 ...  1.2441846  -0.2593694
   -0.7127115 ]
  [-0.49199826 -0.00708523 -0.7401146  ... -0.4541031  -0.47311604
    0.11786263]
  [ 0.9378495  -0.23750474  0.8809972  ... -0.18671606 -0.4551213
   -0.52607685]
  [ 0.9149854  -0.28778902 -0.68483096 ... -0.1768892   0.07016154
   -0.6101497 ]]

 [[-0.2006213  -0.00256501  0.8568901  ... -0.3477501  -1.0085363
    0.8742885 ]
  [-0.4761422   0.80802053  0.38421884 ...  0.9324223   0.31820917
    0.04162993]
  [-0.6254541  -0.22196475 -0.30340576 ...  0.7312764  -0.8267807
    0.83340293]
  [ 0.4238999  -0.93465495 -0.6788466  ... -0.70717376 -0.54580367
   -0.7091748 ]
  [ 0.8732324  -0.40647054  0.43248215 ... -0.93245775 -0.97102326
   -0.96866757]]

 ...

 [[-1.0761149  -0.10352021 -0.5792926  ...  0.52766025 -0.933062
    0.11715425]
  [ 1.1013764   0.6112862  -0.50574607 ... -0.1067775  -0.39957705
   -0.9759675 ]
  [-0.08927392 -0.3305047   0.558563   ... -0.9798508   0.7576455
   -0.62465984]
  [ 0.8637279   0.2563502  -0.74412245 ... -1.0435442   0.40986356
    0.70759875]
  [ 0.81731606  0.28398457  0.8434488  ...  0.05490192 -0.41194773
    1.0669532 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.32313982  0.21801741  0.5478472  ...  0.2779292   0.25922018
    0.44025135]
  [ 1.1380286   0.26938826 -0.01303636 ...  0.7089979   0.42384925
   -0.59004265]
  [-0.13273165 -0.7793084  -0.20103285 ...  0.68746555 -0.40297458
   -0.42612907]
  [ 0.4317707   0.16847211 -0.18435302 ... -0.07847223 -0.36696556
   -0.09855704]
  [-0.78034097 -0.42965394 -0.38443726 ... -0.6996878   0.91378105
   -0.5978208 ]]]
Task 0, Epoch 1/5, Self_training_Iteration: 4 => Loss 0.016, Train_accy 88.66:  20%|█████████████████▌                                                                      | 1/5 [00:42<02:50, 42.73s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 8.3085877e-01 -4.3664038e-02  6.2686372e-01 ...  2.7438772e-01
   -2.4207149e-01 -1.9572626e-01]
  [-9.6892887e-01 -2.4087901e-01  4.0952608e-01 ... -7.8281760e-01
    7.2728163e-01  4.7214839e-01]
  [-4.4044241e-01  8.1705850e-01 -6.5077883e-01 ...  5.2498937e-01
    8.3529532e-01  7.0622045e-01]
  [ 3.4576777e-01  1.3261905e-01  1.2292595e+00 ... -3.4668738e-01
    1.2027942e-01  6.1060405e-01]
  [ 6.5436953e-01 -6.6026491e-01 -1.6488488e-01 ...  3.7437508e-01
   -3.0955702e-01 -5.9959337e-02]]

 [[-1.2650645e-01  7.6270761e-04  1.0717121e-01 ...  1.0889232e-01
   -1.6946445e-01  6.9348657e-01]
  [ 1.1892546e+00 -6.9716370e-01 -4.7971091e-01 ...  1.2334703e+00
   -2.4322230e-01 -7.0225346e-01]
  [-4.9619216e-01  2.6530711e-02 -7.5346971e-01 ... -4.5447290e-01
   -4.9128821e-01  1.2928192e-01]
  [ 9.4806337e-01 -2.6012498e-01  8.7439686e-01 ... -1.5614434e-01
   -4.6587408e-01 -5.4374933e-01]
  [ 8.3729774e-01 -2.8928334e-01 -7.0041543e-01 ... -2.1551923e-01
    7.6673344e-02 -6.3972414e-01]]

 [[-2.0062131e-01 -2.5650100e-03  8.5689008e-01 ... -3.4775010e-01
   -1.0085363e+00  8.7428850e-01]
  [-4.7614220e-01  8.0802053e-01  3.8421884e-01 ...  9.3242228e-01
    3.1820917e-01  4.1629925e-02]
  [-6.2545413e-01 -2.2196475e-01 -3.0340576e-01 ...  7.3127639e-01
   -8.2678068e-01  8.3340293e-01]
  [ 4.2389989e-01 -9.3465495e-01 -6.7884660e-01 ... -7.0717376e-01
   -5.4580367e-01 -7.0917481e-01]
  [ 8.7323242e-01 -4.0647054e-01  4.3248215e-01 ... -9.3245775e-01
   -9.7102326e-01 -9.6866757e-01]]

 ...

 [[-1.1039704e+00 -9.6007429e-02 -5.6016463e-01 ...  5.2834576e-01
   -9.6131361e-01  1.1701097e-01]
  [ 1.1048535e+00  6.3817662e-01 -5.0996804e-01 ... -1.1973600e-01
   -3.5275963e-01 -9.9491602e-01]
  [-7.4141271e-02 -3.0674928e-01  5.6494802e-01 ... -9.8285949e-01
    7.6309448e-01 -6.2362862e-01]
  [ 8.7446332e-01  2.3201376e-01 -7.5677466e-01 ... -1.0605534e+00
    3.8901633e-01  6.9960338e-01]
  [ 8.0098814e-01  2.7727726e-01  8.5114795e-01 ...  2.1058301e-02
   -3.9041036e-01  1.0437336e+00]]

 [[-7.5741208e-01 -5.4697931e-01  2.0942450e-01 ... -5.7844841e-01
    7.3774993e-01  6.3170993e-01]
  [ 5.6927741e-01 -2.3225713e-01 -5.4914522e-01 ... -4.8301125e-01
   -2.7959323e-01 -7.2338915e-01]
  [-3.4088027e-01  6.3905120e-01  5.2556992e-01 ...  2.5032330e-01
    9.7615123e-02  6.7268848e-01]
  [-7.1048629e-01 -4.7325385e-01  6.7840970e-01 ...  7.9269052e-01
    4.5717835e-02  4.6423733e-01]
  [-8.4880126e-01  4.2689371e-01  6.6226137e-01 ... -5.4668033e-01
    4.2980576e-01  8.2954073e-01]]

 [[ 3.6853144e-01  2.1553491e-01  5.6172895e-01 ...  2.9508713e-01
    2.7855837e-01  4.2324805e-01]
  [ 1.1513749e+00  2.6981774e-01 -1.8975118e-02 ...  6.8673933e-01
    3.9031047e-01 -5.8214617e-01]
  [-1.3080207e-01 -7.8414959e-01 -1.9466606e-01 ...  6.7055595e-01
   -4.2455012e-01 -4.4867527e-01]
  [ 4.5794585e-01  1.2514235e-01 -1.5360533e-01 ... -7.3690362e-02
   -3.6838311e-01 -1.0763730e-01]
  [-8.2301915e-01 -4.0929523e-01 -3.7424561e-01 ... -6.8802130e-01
    9.0935045e-01 -5.8698100e-01]]]
Task 0, Epoch 2/5, Self_training_Iteration: 4 => Loss 0.036, Train_accy 88.21:  40%|███████████████████████████████████▏                                                    | 2/5 [01:25<02:08, 42.73s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.8628191  -0.04071892  0.60710895 ...  0.2865078  -0.2660309
   -0.2138027 ]
  [-1.0002913  -0.25016743  0.39550167 ... -0.81203264  0.6980282
    0.4694812 ]
  [-0.43188888  0.8484921  -0.66348374 ...  0.5179764   0.8417221
    0.7414441 ]
  [ 0.3329769   0.14709985  1.2185138  ... -0.3484543   0.13120608
    0.6217425 ]
  [ 0.6661907  -0.67862797 -0.20172545 ...  0.4094085  -0.29621738
   -0.08765405]]

 [[-0.14420584  0.01458477  0.10003255 ...  0.12416748 -0.12484598
    0.6956669 ]
  [ 1.1821539  -0.7166705  -0.53112936 ...  1.2157751  -0.2426138
   -0.71464485]
  [-0.4910559   0.0391301  -0.7780758  ... -0.4396557  -0.48075122
    0.13810301]
  [ 0.91190606 -0.23200577  0.8780044  ... -0.18688655 -0.46971545
   -0.5521974 ]
  [ 0.8472638  -0.3033105  -0.6897628  ... -0.1948724   0.06361509
   -0.64050883]]

 [[-0.2006213  -0.00256501  0.8568901  ... -0.3477501  -1.0085363
    0.8742885 ]
  [-0.4761422   0.80802053  0.38421884 ...  0.9324223   0.31820917
    0.04162993]
  [-0.6254541  -0.22196475 -0.30340576 ...  0.7312764  -0.8267807
    0.83340293]
  [ 0.4238999  -0.93465495 -0.6788466  ... -0.70717376 -0.54580367
   -0.7091748 ]
  [ 0.8732324  -0.40647054  0.43248215 ... -0.93245775 -0.97102326
   -0.96866757]]

 ...

 [[-1.1164246  -0.04851828 -0.54775435 ...  0.50310016 -0.974997
    0.13707699]
  [ 1.11478     0.62281466 -0.5429225  ... -0.12462764 -0.35227108
   -1.0038277 ]
  [-0.06577916 -0.31912658  0.5365797  ... -0.97165257  0.76606685
   -0.6050166 ]
  [ 0.88431764  0.21436997 -0.7526868  ... -1.0445362   0.3940341
    0.6928471 ]
  [ 0.7953595   0.2855207   0.8179436  ... -0.01470281 -0.40590623
    1.0328012 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.36326593  0.22697611  0.5762571  ...  0.3091399   0.23511262
    0.4334214 ]
  [ 1.1792481   0.23994371 -0.05908221 ...  0.65090036  0.3605359
   -0.6110259 ]
  [-0.14476077 -0.7754266  -0.19448556 ...  0.63341576 -0.43519607
   -0.46248874]
  [ 0.47702104  0.14120698 -0.1598048  ... -0.09162339 -0.3554797
   -0.11304217]
  [-0.8121183  -0.4070985  -0.35698658 ... -0.68276244  0.88796604
   -0.57757133]]]
Task 0, Epoch 3/5, Self_training_Iteration: 4 => Loss 0.009, Train_accy 89.45:  60%|████████████████████████████████████████████████████▊                                   | 3/5 [02:08<01:25, 42.74s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.86457413 -0.02419132  0.6333467  ...  0.3172233  -0.2744774
   -0.24118292]
  [-1.0110645  -0.23391628  0.42408666 ... -0.82680565  0.7300204
    0.43881652]
  [-0.42433894  0.8772054  -0.67779684 ...  0.5516182   0.84454566
    0.7438402 ]
  [ 0.32484752  0.13804293  1.2226678  ... -0.35761338  0.13975011
    0.6265302 ]
  [ 0.61859167 -0.6918501  -0.20266473 ...  0.42590854 -0.31470048
   -0.08269506]]

 [[-0.16157566  0.02333736  0.12511602 ...  0.12800212 -0.11748882
    0.66325265]
  [ 1.2104071  -0.7398129  -0.56876385 ...  1.2428584  -0.26064077
   -0.73861504]
  [-0.49354544  0.02495874 -0.7589778  ... -0.42951792 -0.47549975
    0.08917554]
  [ 0.8928351  -0.2501854   0.8408217  ... -0.2023285  -0.4822519
   -0.5891312 ]
  [ 0.8690442  -0.301804   -0.67825514 ... -0.1785141   0.09838255
   -0.63461167]]

 [[-0.2006213  -0.00256501  0.8568901  ... -0.3477501  -1.0085363
    0.8742885 ]
  [-0.4761422   0.80802053  0.38421884 ...  0.9324223   0.31820917
    0.04162993]
  [-0.6254541  -0.22196475 -0.30340576 ...  0.7312764  -0.8267807
    0.83340293]
  [ 0.4238999  -0.93465495 -0.6788466  ... -0.70717376 -0.54580367
   -0.7091748 ]
  [ 0.8732324  -0.40647054  0.43248215 ... -0.93245775 -0.97102326
   -0.96866757]]

 ...

 [[-1.0866817  -0.04166249 -0.55958    ...  0.4966723  -0.9524729
    0.1419236 ]
  [ 1.1072079   0.62776065 -0.5669508  ... -0.11678642 -0.36889505
   -1.0161417 ]
  [-0.05018918 -0.3339103   0.55165493 ... -0.99834764  0.7662392
   -0.6247554 ]
  [ 0.866974    0.19048746 -0.7435193  ... -1.0377855   0.3336071
    0.63838196]
  [ 0.8040282   0.28700718  0.7920859  ... -0.00135185 -0.42475465
    1.0362484 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.3763566   0.23999217  0.5733702  ...  0.32623264  0.21844772
    0.4330188 ]
  [ 1.1845492   0.23910767 -0.05797099 ...  0.63207734  0.33464417
   -0.5930268 ]
  [-0.15789586 -0.7938012  -0.18646356 ...  0.5858774  -0.47807607
   -0.46300814]
  [ 0.48927397  0.14088644 -0.13419458 ... -0.09885269 -0.35413536
   -0.10838607]
  [-0.82857823 -0.43488643 -0.34276998 ... -0.6897159   0.88744444
   -0.5974637 ]]]
Task 0, Epoch 4/5, Self_training_Iteration: 4 => Loss 0.000, Train_accy 89.71:  80%|██████████████████████████████████████████████████████████████████████▍                 | 4/5 [02:50<00:42, 42.74s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.84115034 -0.03687025  0.62377405 ...  0.31462526 -0.19088756
   -0.20213012]
  [-1.0191435  -0.22121252  0.38812646 ... -0.8673755   0.7767358
    0.45235035]
  [-0.45320386  0.8905593  -0.66060406 ...  0.5412693   0.8325861
    0.75450534]
  [ 0.35884246  0.12288636  1.218804   ... -0.38011917  0.1306027
    0.61607367]
  [ 0.6355195  -0.69966245 -0.16204341 ...  0.45593792 -0.2805238
   -0.08391364]]

 [[-0.15742859  0.02632249  0.1458971  ...  0.10710736 -0.09441214
    0.69932246]
  [ 1.175165   -0.74049425 -0.56808335 ...  1.2217638  -0.25945312
   -0.7555723 ]
  [-0.5052527   0.03278914 -0.7745004  ... -0.4058551  -0.4748451
    0.08122531]
  [ 0.86872846 -0.22901426  0.8566285  ... -0.21136762 -0.4604927
   -0.632942  ]
  [ 0.8383703  -0.28062296 -0.6402559  ... -0.16274719  0.10689256
   -0.63428366]]

 [[-0.2006213  -0.00256501  0.8568901  ... -0.3477501  -1.0085363
    0.8742885 ]
  [-0.4761422   0.80802053  0.38421884 ...  0.9324223   0.31820917
    0.04162993]
  [-0.6254541  -0.22196475 -0.30340576 ...  0.7312764  -0.8267807
    0.83340293]
  [ 0.4238999  -0.93465495 -0.6788466  ... -0.70717376 -0.54580367
   -0.7091748 ]
  [ 0.8732324  -0.40647054  0.43248215 ... -0.93245775 -0.97102326
   -0.96866757]]

 ...

 [[-1.0985751  -0.03077443 -0.5338539  ...  0.46569896 -0.95063794
    0.15401326]
  [ 1.1238315   0.62854964 -0.5807352  ... -0.0918743  -0.37158298
   -0.99049777]
  [-0.03250825 -0.32975882  0.52929395 ... -1.0043089   0.78028274
   -0.61664987]
  [ 0.8571523   0.196      -0.75448203 ... -1.0529493   0.3072765
    0.66934717]
  [ 0.8093608   0.30639687  0.7552568  ...  0.0189137  -0.4120834
    1.0123818 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.35364196  0.22230744  0.59668726 ...  0.31110668  0.22026776
    0.44523725]
  [ 1.2520983   0.21157052 -0.04522037 ...  0.6198732   0.311144
   -0.5869857 ]
  [-0.15248352 -0.7322692  -0.254111   ...  0.53050745 -0.437016
   -0.5265766 ]
  [ 0.49527627  0.13301523 -0.13685414 ... -0.10884076 -0.3607517
   -0.09438153]
  [-0.84998596 -0.43452507 -0.3057685  ... -0.6787592   0.8930099
   -0.6062526 ]]]
tensor([6, 2, 9, 3, 6, 4, 0, 6, 3, 7, 0, 1, 8, 5, 1, 3], device='cuda:5')
tensor([0, 2, 5, 5, 9, 8, 4, 6, 9, 9, 2, 7, 3, 0, 6, 1], device='cuda:5')
tensor([8, 5, 7, 7, 6, 2, 5, 8, 0, 6, 3, 9, 2, 4, 7, 5], device='cuda:5')
tensor([3, 7, 3, 6, 6, 8, 7, 7, 9, 3, 1, 5, 3, 4, 1, 6], device='cuda:5')
tensor([8, 9, 0, 3, 6, 9, 3, 2, 1, 3, 4, 5, 4, 8, 1, 4], device='cuda:5')
Task 0, Epoch 5/5, Self_training_Iteration: 4 => Loss 0.024, Train_accy 89.30, Test_accy 95.40: 100%|███████████████████████████████████████████████████████████████████████| 5/5 [03:40<00:00, 44.01s/it]
2023-12-20 19:45:37,152 [l2p_self_training.py] => Task 0, Epoch 5/5, Self_training_Iteration: 4 => Loss 0.024, Train_accy 89.30, Test_accy 95.40
2023-12-20 19:45:37,155 [l2p_self_training.py] => Here are still 352 unlabeled samples left
2023-12-20 19:45:37,155 [l2p_self_training.py] => pseudo labeling start
2023-12-20 19:45:39,743 [l2p_self_training.py] => 112 unlabeled samples will be pseudo labeled
2023-12-20 19:45:39,743 [l2p_self_training.py] => pseudo labeling finish
Pseudo Accuracy:  0.8214285714285714
2023-12-20 19:45:46,098 [trainer.py] => No NME accuracy.
2023-12-20 19:45:46,098 [trainer.py] => CNN: {'total': 95.4, '00-09': 95.4, 'old': 0, 'new': 95.4}
2023-12-20 19:45:46,098 [trainer.py] => CNN top1 curve: [95.4]
2023-12-20 19:45:46,098 [trainer.py] => CNN top5 curve: [99.6]

Average Accuracy (CNN): 95.4
2023-12-20 19:45:46,098 [trainer.py] => Average Accuracy (CNN): 95.4 

2023-12-20 19:45:46,103 [trainer.py] => All params: 171816392
2023-12-20 19:45:46,105 [trainer.py] => Trainable params: 122980
2023-12-20 19:45:46,106 [l2p_self_training.py] => Learning on 10-20
  0%|                                                                                                                                                                               | 0/5 [00:00<?, ?it/s]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.83303535 -0.0344297   0.64271045 ...  0.3154276  -0.18488252
   -0.21783714]
  [-1.0148227  -0.23387899  0.37914905 ... -0.8749175   0.7812475
    0.45429853]
  [-0.4403291   0.8865849  -0.6467567  ...  0.5360064   0.8355525
    0.7573213 ]
  [ 0.37240914  0.13214684  1.2140828  ... -0.38723662  0.13681383
    0.6200442 ]
  [ 0.63935435 -0.6855286  -0.15692423 ...  0.471615   -0.27857903
   -0.07709451]]

 [[-0.16840371  0.01550926  0.14303242 ...  0.09771261 -0.09128995
    0.7048131 ]
  [ 1.1753106  -0.7212492  -0.56776524 ...  1.2349888  -0.28290302
   -0.74993575]
  [-0.49406207  0.01736576 -0.7637604  ... -0.40382445 -0.47114086
    0.08313341]
  [ 0.8680461  -0.25272912  0.86463565 ... -0.2063234  -0.45484564
   -0.6332792 ]
  [ 0.8469294  -0.2835511  -0.6376949  ... -0.1562857   0.11161731
   -0.62704587]]

 [[-0.2006213  -0.00256501  0.8568901  ... -0.3477501  -1.0085363
    0.8742885 ]
  [-0.4761422   0.80802053  0.38421884 ...  0.9324223   0.31820917
    0.04162993]
  [-0.6254541  -0.22196475 -0.30340576 ...  0.7312764  -0.8267807
    0.83340293]
  [ 0.4238999  -0.93465495 -0.6788466  ... -0.70717376 -0.54580367
   -0.7091748 ]
  [ 0.8732324  -0.40647054  0.43248215 ... -0.93245775 -0.97102326
   -0.96866757]]

 ...

 [[-1.1029707  -0.04172766 -0.527644   ...  0.46282032 -0.94062304
    0.14988162]
  [ 1.130639    0.6370574  -0.57695234 ... -0.08563355 -0.368122
   -0.9943885 ]
  [-0.03492448 -0.3191227   0.5226199  ... -0.99867225  0.7704852
   -0.6028078 ]
  [ 0.8401251   0.19726421 -0.7455224  ... -1.0531118   0.31212538
    0.66648734]
  [ 0.8019719   0.30157927  0.7515824  ...  0.01693835 -0.42457372
    1.0229956 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.35829967  0.23092046  0.5879492  ...  0.30502146  0.21902777
    0.44259313]
  [ 1.248002    0.20189114 -0.05729081 ...  0.6174565   0.3215109
   -0.5911454 ]
  [-0.142052   -0.7381293  -0.26188365 ...  0.5396801  -0.43317506
   -0.5240905 ]
  [ 0.4877747   0.12770426 -0.13032618 ... -0.11148562 -0.36279592
   -0.10215159]
  [-0.8428615  -0.42452338 -0.30937424 ... -0.6865243   0.8883497
   -0.6107112 ]]]
Task 1, Epoch 1/5, Self_training_Iteration: 0 => Loss 1.275, Train_accy 46.80:  20%|█████████████████▌                                                                      | 1/5 [00:02<00:11,  2.76s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.83006555 -0.03037362  0.65258247 ...  0.3183746  -0.18067758
   -0.22024165]
  [-0.998749   -0.22702022  0.39271477 ... -0.8696417   0.78227836
    0.46594793]
  [-0.43024892  0.8678549  -0.6330944  ...  0.53196675  0.8268166
    0.7524148 ]
  [ 0.3792601   0.13794446  1.2162598  ... -0.39213195  0.14580221
    0.6209298 ]
  [ 0.64982545 -0.67464834 -0.15139723 ...  0.48524743 -0.27845824
   -0.06831063]]

 [[-0.17887898  0.00321029  0.13304462 ...  0.07754669 -0.07542624
    0.7203302 ]
  [ 1.1806176  -0.7113495  -0.566389   ...  1.2441634  -0.30236933
   -0.7450829 ]
  [-0.4847361   0.01480402 -0.74609226 ... -0.41647315 -0.46165934
    0.08086181]
  [ 0.85992265 -0.26043737  0.8694634  ... -0.19547138 -0.44025677
   -0.6264895 ]
  [ 0.85929745 -0.30113927 -0.6375209  ... -0.15097742  0.10954883
   -0.6136723 ]]

 [[-0.2006213  -0.00256501  0.8568901  ... -0.3477501  -1.0085363
    0.8742885 ]
  [-0.4761422   0.80802053  0.38421884 ...  0.9324223   0.31820917
    0.04162993]
  [-0.6254541  -0.22196475 -0.30340576 ...  0.7312764  -0.8267807
    0.83340293]
  [ 0.4238999  -0.93465495 -0.6788466  ... -0.70717376 -0.54580367
   -0.7091748 ]
  [ 0.8732324  -0.40647054  0.43248215 ... -0.93245775 -0.97102326
   -0.96866757]]

 ...

 [[-1.1121886  -0.05113175 -0.52599746 ...  0.46327183 -0.9369371
    0.15164381]
  [ 1.1203271   0.6472645  -0.56889606 ... -0.07395075 -0.350106
   -0.99422234]
  [-0.032486   -0.317375    0.5110718  ... -0.9887166   0.75459564
   -0.59655887]
  [ 0.8275843   0.19637011 -0.73827684 ... -1.0412705   0.31337053
    0.6659077 ]
  [ 0.7996014   0.294145    0.75199676 ...  0.01734934 -0.42950216
    1.0243317 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.36870113  0.23216495  0.57534075 ...  0.30446264  0.21253951
    0.4359608 ]
  [ 1.2398325   0.20809516 -0.07076889 ...  0.6308657   0.32695565
   -0.59847456]
  [-0.13795361 -0.7451582  -0.26821467 ...  0.5484422  -0.4406778
   -0.5210256 ]
  [ 0.48413077  0.11523323 -0.12861857 ... -0.10716696 -0.35682178
   -0.10920905]
  [-0.84273255 -0.41665572 -0.31642535 ... -0.6944782   0.8796851
   -0.6136768 ]]]
Task 1, Epoch 2/5, Self_training_Iteration: 0 => Loss 0.257, Train_accy 82.80:  40%|███████████████████████████████████▏                                                    | 2/5 [00:05<00:08,  2.77s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.82768804 -0.02649522  0.65416574 ...  0.3171652  -0.17723857
   -0.2243057 ]
  [-0.9887198  -0.23062871  0.40133202 ... -0.8762525   0.7868361
    0.46384   ]
  [-0.42647558  0.8555048  -0.6237813  ...  0.52868104  0.81757104
    0.7488428 ]
  [ 0.3895934   0.13848135  1.2198249  ... -0.39278674  0.14334947
    0.6182236 ]
  [ 0.65897316 -0.6710387  -0.14530468 ...  0.48897997 -0.2795986
   -0.06684209]]

 [[-0.18583724 -0.01144103  0.1259887  ...  0.06720552 -0.06588089
    0.7327061 ]
  [ 1.1861861  -0.7009171  -0.5765842  ...  1.2454512  -0.3167583
   -0.73771447]
  [-0.48007378  0.01476803 -0.7353721  ... -0.42337745 -0.45391262
    0.07570489]
  [ 0.8541642  -0.26054507  0.8708214  ... -0.18426326 -0.437468
   -0.62380594]
  [ 0.8666613  -0.30850554 -0.64239395 ... -0.1475449   0.11154792
   -0.60964686]]

 [[-0.2006213  -0.00256501  0.8568901  ... -0.3477501  -1.0085363
    0.8742885 ]
  [-0.4761422   0.80802053  0.38421884 ...  0.9324223   0.31820917
    0.04162993]
  [-0.6254541  -0.22196475 -0.30340576 ...  0.7312764  -0.8267807
    0.83340293]
  [ 0.4238999  -0.93465495 -0.6788466  ... -0.70717376 -0.54580367
   -0.7091748 ]
  [ 0.8732324  -0.40647054  0.43248215 ... -0.93245775 -0.97102326
   -0.96866757]]

 ...

 [[-1.1134932  -0.0530151  -0.5208725  ...  0.46027172 -0.9377672
    0.1509506 ]
  [ 1.1164641   0.65599036 -0.5681823  ... -0.06465463 -0.34514627
   -0.99280226]
  [-0.02452512 -0.3101381   0.49732152 ... -0.9860141   0.74873847
   -0.59805125]
  [ 0.82206905  0.20034397 -0.7387988  ... -1.0391942   0.3131471
    0.6585049 ]
  [ 0.8011234   0.28964853  0.7551689  ...  0.01779937 -0.43551314
    1.0297245 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.3733479   0.23700659  0.57333153 ...  0.3055401   0.20714445
    0.43597668]
  [ 1.2350177   0.21163918 -0.07443891 ...  0.6355706   0.32411405
   -0.60392195]
  [-0.1299569  -0.7421893  -0.27079704 ...  0.55777884 -0.44250104
   -0.51903254]
  [ 0.48102605  0.10935353 -0.12758836 ... -0.10111611 -0.3457002
   -0.10785247]
  [-0.8358029  -0.4089955  -0.3275587  ... -0.69766194  0.8729815
   -0.61177146]]]
Task 1, Epoch 3/5, Self_training_Iteration: 0 => Loss 0.066, Train_accy 88.00:  60%|████████████████████████████████████████████████████▊                                   | 3/5 [00:08<00:05,  2.77s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.8237375  -0.02287588  0.66143423 ...  0.3169327  -0.17322105
   -0.22973488]
  [-0.98129463 -0.23004153  0.40574032 ... -0.87729234  0.7827043
    0.46181914]
  [-0.4240194   0.8479607  -0.61714685 ...  0.52110684  0.81510735
    0.74202734]
  [ 0.39369342  0.14732102  1.2237792  ... -0.38595527  0.14893036
    0.6202947 ]
  [ 0.67305976 -0.6653709  -0.13969572 ...  0.4983388  -0.2789215
   -0.06148617]]

 [[-0.18902832 -0.02054605  0.11610153 ...  0.07276075 -0.06149879
    0.74298245]
  [ 1.1893779  -0.6960774  -0.5793607  ...  1.2495024  -0.32019413
   -0.74094003]
  [-0.47770193  0.01687245 -0.7273883  ... -0.43091828 -0.45071048
    0.07327548]
  [ 0.846849   -0.2613627   0.86901915 ... -0.17745513 -0.4315829
   -0.62611586]
  [ 0.8667192  -0.3155373  -0.646779   ... -0.13407369  0.11046098
   -0.6135566 ]]

 [[-0.2006213  -0.00256501  0.8568901  ... -0.3477501  -1.0085363
    0.8742885 ]
  [-0.4761422   0.80802053  0.38421884 ...  0.9324223   0.31820917
    0.04162993]
  [-0.6254541  -0.22196475 -0.30340576 ...  0.7312764  -0.8267807
    0.83340293]
  [ 0.4238999  -0.93465495 -0.6788466  ... -0.70717376 -0.54580367
   -0.7091748 ]
  [ 0.8732324  -0.40647054  0.43248215 ... -0.93245775 -0.97102326
   -0.96866757]]

 ...

 [[-1.114441   -0.05056082 -0.51988304 ...  0.45794797 -0.9355999
    0.14676502]
  [ 1.11369     0.6560642  -0.5670743  ... -0.06162232 -0.3431466
   -0.9986557 ]
  [-0.0225284  -0.31148914  0.49691227 ... -0.97761077  0.7402644
   -0.593627  ]
  [ 0.8166622   0.20050736 -0.73907113 ... -1.0354235   0.3226717
    0.65288574]
  [ 0.799883    0.285848    0.74883246 ...  0.0108894  -0.4348404
    1.0336125 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.37880433  0.2359037   0.5690889  ...  0.30533224  0.19957006
    0.42491442]
  [ 1.228677    0.22156931 -0.08349731 ...  0.6459847   0.3254832
   -0.6057447 ]
  [-0.12963256 -0.7500398  -0.26772466 ...  0.56375897 -0.45032907
   -0.5138169 ]
  [ 0.4827083   0.10627138 -0.12690653 ... -0.10031623 -0.3445461
   -0.11585654]
  [-0.83891034 -0.40812865 -0.3326563  ... -0.7011244   0.8702172
   -0.60805935]]]
Task 1, Epoch 4/5, Self_training_Iteration: 0 => Loss 0.018, Train_accy 90.00:  80%|██████████████████████████████████████████████████████████████████████▍                 | 4/5 [00:11<00:02,  2.78s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.80898756 -0.01856037  0.6661882  ...  0.31611153 -0.16543296
   -0.2306127 ]
  [-0.9804589  -0.23055868  0.40931255 ... -0.86933005  0.78220105
    0.4639626 ]
  [-0.42269698  0.84604245 -0.6121169  ...  0.5195522   0.8097841
    0.73923975]
  [ 0.38976532  0.15306309  1.2224511  ... -0.38282573  0.15094496
    0.6165799 ]
  [ 0.67747194 -0.6685228  -0.13241325 ...  0.50739545 -0.27728787
   -0.05530296]]

 [[-0.19466496 -0.01871468  0.11045866 ...  0.07319363 -0.05415568
    0.75255495]
  [ 1.1839283  -0.6931178  -0.5800546  ...  1.2577986  -0.3310268
   -0.74193007]
  [-0.47728634  0.01724262 -0.721578   ... -0.4411503  -0.44605163
    0.07315298]
  [ 0.8471193  -0.25934252  0.8634424  ... -0.16441478 -0.4308911
   -0.62474716]
  [ 0.8685705  -0.3236917  -0.6485873  ... -0.13103548  0.11186358
   -0.6148497 ]]

 [[-0.2006213  -0.00256501  0.8568901  ... -0.3477501  -1.0085363
    0.8742885 ]
  [-0.4761422   0.80802053  0.38421884 ...  0.9324223   0.31820917
    0.04162993]
  [-0.6254541  -0.22196475 -0.30340576 ...  0.7312764  -0.8267807
    0.83340293]
  [ 0.4238999  -0.93465495 -0.6788466  ... -0.70717376 -0.54580367
   -0.7091748 ]
  [ 0.8732324  -0.40647054  0.43248215 ... -0.93245775 -0.97102326
   -0.96866757]]

 ...

 [[-1.1132773  -0.05311325 -0.51691294 ...  0.45495674 -0.92769784
    0.14640307]
  [ 1.1126659   0.6548399  -0.56514925 ... -0.06450933 -0.33960173
   -1.0028685 ]
  [-0.01237481 -0.3098252   0.491702   ... -0.9741259   0.7363925
   -0.5942992 ]
  [ 0.8094227   0.20124057 -0.74463964 ... -1.0334064   0.3288356
    0.6510508 ]
  [ 0.80747885  0.2800491   0.7473971  ...  0.01072817 -0.44355768
    1.0371529 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.37793437  0.23186095  0.56714183 ...  0.3074396   0.19011551
    0.42377168]
  [ 1.2290086   0.22831036 -0.08315478 ...  0.65028846  0.3239706
   -0.6048366 ]
  [-0.13095635 -0.7529269  -0.26757476 ...  0.5708473  -0.45777926
   -0.51219344]
  [ 0.48120496  0.10310658 -0.12460425 ... -0.09691297 -0.34176388
   -0.12323329]
  [-0.8420339  -0.4057174  -0.33920494 ... -0.7020555   0.8709285
   -0.60761636]]]
tensor([13,  5,  9,  5,  3,  3,  3,  9, 16,  8, 15,  5,  8,  5,  5, 13],
       device='cuda:5')
tensor([ 5,  3,  3,  5,  7,  1, 11,  0, 18, 13, 15,  7,  5, 13,  4,  6],
       device='cuda:5')
tensor([12,  0,  3,  6,  3,  4, 12, 17,  2, 11, 13, 13,  1,  7, 15,  8],
       device='cuda:5')
tensor([ 9,  7,  2,  4,  6,  5,  8,  7,  4,  0, 15,  5,  8, 16, 19,  8],
       device='cuda:5')
tensor([ 8,  3, 19,  5,  7,  8, 16,  2,  6,  3,  2,  6, 11,  6,  3,  2],
       device='cuda:5')
Task 1, Epoch 5/5, Self_training_Iteration: 0 => Loss 0.005, Train_accy 89.20, Test_accy 75.65: 100%|███████████████████████████████████████████████████████████████████████| 5/5 [00:26<00:00,  5.21s/it]
2023-12-20 19:46:12,307 [l2p_self_training.py] => Task 1, Epoch 5/5, Self_training_Iteration: 0 => Loss 0.005, Train_accy 89.20, Test_accy 75.65
2023-12-20 19:46:12,311 [l2p_self_training.py] => Here are still 4761 unlabeled samples left
2023-12-20 19:46:12,312 [l2p_self_training.py] => pseudo labeling start
2023-12-20 19:46:40,748 [l2p_self_training.py] => 1758 unlabeled samples will be pseudo labeled
2023-12-20 19:46:40,748 [l2p_self_training.py] => pseudo labeling finish
Pseudo Accuracy:  0.5164960182025028
  0%|                                                                                                                                                                               | 0/5 [00:00<?, ?it/s]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.75738335 -0.2128735   0.45620587 ...  0.63738406 -0.01314123
   -0.00450556]
  [-0.9750264  -0.03921575  0.34815198 ... -0.6227052   0.9149926
    0.49207088]
  [-0.55146086  0.9745241  -0.63606405 ...  0.4698102   1.1019255
    0.8692168 ]
  [ 0.42793775  0.26656055  1.0296273  ... -0.07276941  0.08498708
    0.686517  ]
  [ 0.5457791  -0.8232431  -0.04073835 ...  0.6247927  -0.49798742
    0.11857733]]

 [[ 0.07160048  0.31115273 -0.05986854 ...  0.2836958   0.20885268
    0.47732377]
  [ 1.1342597  -0.9303582  -0.40428242 ...  1.3513086   0.01293664
   -0.9099031 ]
  [-0.46150622 -0.12649217 -0.69523865 ... -0.58598953 -0.18879128
    0.27706107]
  [ 0.8119246  -0.13480954  0.8413712  ...  0.1246628  -0.70968777
   -0.51230353]
  [ 0.7304789  -0.3194652  -0.48045257 ...  0.07023414 -0.245741
   -0.8161178 ]]

 [[-0.2006213  -0.00256501  0.8568901  ... -0.3477501  -1.0085363
    0.8742885 ]
  [-0.4761422   0.80802053  0.38421884 ...  0.9324223   0.31820917
    0.04162993]
  [-0.6254541  -0.22196475 -0.30340576 ...  0.7312764  -0.8267807
    0.83340293]
  [ 0.4238999  -0.93465495 -0.6788466  ... -0.70717376 -0.54580367
   -0.7091748 ]
  [ 0.8732324  -0.40647054  0.43248215 ... -0.93245775 -0.97102326
   -0.96866757]]

 ...

 [[-0.853004   -0.34839115 -0.34089306 ...  0.53873765 -0.75482416
    0.23570895]
  [ 0.7754215   0.93539786 -0.22604243 ... -0.31593868  0.09126037
   -1.3517259 ]
  [-0.18522856 -0.5879405   0.24329731 ... -0.90805095  0.7259384
   -0.7521528 ]
  [ 0.9853182   0.5111629  -0.80822104 ... -0.80254656  0.5219844
    0.46316773]
  [ 0.618375    0.5430075   0.7627817  ...  0.34378156 -0.40992168
    0.9082937 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.56884617 -0.02380796  0.38164157 ...  0.19144627  0.22963578
    0.27300602]
  [ 1.1242182   0.2814166  -0.32937852 ...  0.9674826   0.6071204
   -0.8462092 ]
  [-0.10968501 -0.71578616 -0.2682185  ...  0.6709047  -0.6476287
   -0.4364089 ]
  [ 0.37627864  0.41384184 -0.3747538  ...  0.20765921 -0.4447388
   -0.12436654]
  [-0.58906674 -0.14128259 -0.4968848  ... -0.3409104   1.1204312
   -0.8535124 ]]]
Task 1, Epoch 1/5, Self_training_Iteration: 1 => Loss inf, Train_accy 52.79:  20%|██████████████████                                                                        | 1/5 [00:18<01:15, 18.82s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.54562575 -0.16648534  0.12141752 ...  0.6385873   0.19715439
   -0.17465453]
  [-0.6539497  -0.13740447  0.25967816 ... -0.3980539   0.98010993
    0.3047567 ]
  [-0.41952014  0.68541574 -0.5380003  ...  0.45354435  0.97271883
    0.70193917]
  [ 0.30200195  0.20586081  0.6701542  ... -0.09116776  0.05527088
    0.36588353]
  [ 0.5659684  -0.9911758  -0.4572684  ...  0.60875803 -0.4546121
   -0.14468278]]

 [[-0.23996566  0.54565674 -0.35761657 ... -0.15785898  0.20017402
    0.08402415]
  [ 0.94446945 -0.8363111  -0.18585806 ...  1.0576692   0.01300182
   -1.0008808 ]
  [-0.34266752 -0.08222394 -0.650209   ... -0.5947189   0.07311913
    0.33380437]
  [ 0.6947173   0.00349524  0.4977049  ...  0.44256732 -0.86658853
   -0.5259724 ]
  [ 0.9052015  -0.50038606 -0.5434542  ...  0.18543136 -0.26440236
   -1.0191921 ]]

 [[-0.2006213  -0.00256501  0.8568901  ... -0.3477501  -1.0085363
    0.8742885 ]
  [-0.4761422   0.80802053  0.38421884 ...  0.9324223   0.31820917
    0.04162993]
  [-0.6254541  -0.22196475 -0.30340576 ...  0.7312764  -0.8267807
    0.83340293]
  [ 0.4238999  -0.93465495 -0.6788466  ... -0.70717376 -0.54580367
   -0.7091748 ]
  [ 0.8732324  -0.40647054  0.43248215 ... -0.93245775 -0.97102326
   -0.96866757]]

 ...

 [[-0.60150844 -0.62230456 -0.1725099  ...  0.4723322  -0.46809617
    0.24773744]
  [ 0.43408942  1.1054581   0.05477294 ... -0.2613674   0.2014764
   -1.6356477 ]
  [-0.4301397  -0.6066773   0.2518934  ... -0.8239274   0.65382975
   -0.9750646 ]
  [ 0.7643773   0.6308387  -0.8570537  ... -0.524573    0.33535895
    0.32081535]
  [ 0.4751369   0.5518846   0.9289652  ...  0.46368706 -0.4717411
    0.48363388]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.60351175  0.14446443  0.12675296 ...  0.17128791  0.30254653
    0.00478685]
  [ 1.0757049   0.14967704 -0.33544213 ...  1.1539094   0.55964416
   -1.2232078 ]
  [-0.07261589 -0.41546234  0.1365845  ...  0.821529   -0.58444786
   -0.43879485]
  [ 0.57952106  0.23711443 -0.72367334 ...  0.02712322 -0.4081993
   -0.31869528]
  [-0.45672134 -0.3045021  -0.8256008  ... -0.18586579  1.2107066
   -1.1576807 ]]]
Task 1, Epoch 2/5, Self_training_Iteration: 1 => Loss inf, Train_accy 44.57:  40%|████████████████████████████████████                                                      | 2/5 [00:37<00:56, 18.76s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 5.6547374e-01 -4.7461480e-02 -1.7518087e-01 ...  7.8749758e-01
    1.3887918e-01 -3.0797699e-01]
  [-6.4578652e-01 -1.9940270e-01  2.3243277e-01 ... -1.5666294e-01
    8.4304404e-01 -4.4453016e-04]
  [-2.9091713e-01  5.7114327e-01 -6.6913128e-01 ...  4.0093869e-01
    7.4930120e-01  5.8383799e-01]
  [ 3.8115719e-01  3.6936772e-01  4.3831229e-01 ... -1.2068843e-01
   -7.7318433e-03  3.7558830e-01]
  [ 4.1269255e-01 -1.0514332e+00 -7.5898629e-01 ...  5.4534954e-01
   -3.0604759e-01 -1.7752886e-01]]

 [[-4.2375088e-01  5.1413900e-01 -3.1338519e-01 ... -5.0527209e-01
    2.6063398e-01 -4.2376913e-02]
  [ 6.8459320e-01 -9.2025185e-01 -1.3289319e-01 ...  7.9059613e-01
   -9.7341314e-02 -1.0351129e+00]
  [-2.9525527e-01 -2.2787081e-02 -7.9669297e-01 ... -3.6695606e-01
    1.4354596e-01  4.1813970e-01]
  [ 4.6041155e-01  5.4067958e-02  2.8327349e-01 ...  6.0180700e-01
   -8.3483058e-01 -6.7373943e-01]
  [ 8.3273476e-01 -4.2885825e-01 -3.7599832e-01 ...  2.0907921e-01
   -2.7411908e-01 -1.1322147e+00]]

 [[-2.0062131e-01 -2.5650100e-03  8.5689008e-01 ... -3.4775010e-01
   -1.0085363e+00  8.7428850e-01]
  [-4.7614220e-01  8.0802053e-01  3.8421884e-01 ...  9.3242228e-01
    3.1820917e-01  4.1629925e-02]
  [-6.2545413e-01 -2.2196475e-01 -3.0340576e-01 ...  7.3127639e-01
   -8.2678068e-01  8.3340293e-01]
  [ 4.2389989e-01 -9.3465495e-01 -6.7884660e-01 ... -7.0717376e-01
   -5.4580367e-01 -7.0917481e-01]
  [ 8.7323242e-01 -4.0647054e-01  4.3248215e-01 ... -9.3245775e-01
   -9.7102326e-01 -9.6866757e-01]]

 ...

 [[-4.1991985e-01 -8.3841741e-01 -8.0273435e-02 ...  5.2877516e-01
   -5.2604246e-01  1.2788066e-01]
  [ 3.0714297e-01  8.7776893e-01  1.5560739e-01 ... -2.8766242e-01
    1.7051640e-01 -1.7445575e+00]
  [-4.9721539e-01 -5.5809426e-01  3.7666556e-01 ... -6.1637247e-01
    4.4975799e-01 -1.0329580e+00]
  [ 5.5472940e-01  7.3557198e-01 -7.2208816e-01 ... -1.9830100e-01
    3.2498959e-01  2.2536010e-01]
  [ 4.2090371e-01  8.7459230e-01  4.6572295e-01 ...  5.4112428e-01
   -3.7801713e-01  2.0314153e-01]]

 [[-7.5741208e-01 -5.4697931e-01  2.0942450e-01 ... -5.7844841e-01
    7.3774993e-01  6.3170993e-01]
  [ 5.6927741e-01 -2.3225713e-01 -5.4914522e-01 ... -4.8301125e-01
   -2.7959323e-01 -7.2338915e-01]
  [-3.4088027e-01  6.3905120e-01  5.2556992e-01 ...  2.5032330e-01
    9.7615123e-02  6.7268848e-01]
  [-7.1048629e-01 -4.7325385e-01  6.7840970e-01 ...  7.9269052e-01
    4.5717835e-02  4.6423733e-01]
  [-8.4880126e-01  4.2689371e-01  6.6226137e-01 ... -5.4668033e-01
    4.2980576e-01  8.2954073e-01]]

 [[ 7.6724833e-01  2.2699863e-01 -5.5936580e-03 ...  1.6417006e-01
    3.3866006e-01 -1.4776877e-01]
  [ 1.1110582e+00  6.6312991e-02 -1.8969223e-01 ...  1.1035794e+00
    4.3581605e-01 -1.4189818e+00]
  [-5.4188546e-02 -3.9448008e-01  3.2792133e-01 ...  9.5374262e-01
   -6.0327369e-01 -5.4776078e-01]
  [ 5.7940185e-01  1.9475932e-01 -9.5259333e-01 ... -3.0864727e-02
   -4.0631703e-01 -4.3063983e-01]
  [-1.8521261e-01 -4.1883305e-01 -8.5283279e-01 ... -2.2724892e-01
    1.0709052e+00 -1.1376253e+00]]]
Task 1, Epoch 3/5, Self_training_Iteration: 1 => Loss inf, Train_accy 38.55:  60%|██████████████████████████████████████████████████████                                    | 3/5 [00:56<00:37, 18.81s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 0.40963888  0.05859204 -0.3729163  ...  0.9658363   0.03892529
   -0.33150727]
  [-0.61248523 -0.18262297  0.20010927 ...  0.07890072  0.81262773
   -0.05828335]
  [-0.13509618  0.56845975 -0.7839057  ...  0.29688835  0.4722916
    0.51369435]
  [ 0.36979386  0.54186136  0.23342212 ... -0.08943295 -0.0385384
    0.32357153]
  [ 0.21797659 -0.93543106 -0.94638145 ...  0.5716371  -0.25394493
   -0.17830895]]

 [[-0.51015556  0.51936334 -0.37624988 ... -0.72807723  0.25001767
   -0.07911948]
  [ 0.4304602  -0.9076707  -0.13866843 ...  0.7633171  -0.15311466
   -0.9977704 ]
  [-0.40585676 -0.05497558 -0.9858183  ... -0.17830281  0.11594671
    0.5558382 ]
  [ 0.24113084  0.12050138  0.14145444 ...  0.5997762  -0.8775018
   -0.84614253]
  [ 0.7099243  -0.2485427  -0.18002969 ...  0.475627   -0.31344724
   -1.1018345 ]]

 [[-0.2006213  -0.00256501  0.8568901  ... -0.3477501  -1.0085363
    0.8742885 ]
  [-0.4761422   0.80802053  0.38421884 ...  0.9324223   0.31820917
    0.04162993]
  [-0.6254541  -0.22196475 -0.30340576 ...  0.7312764  -0.8267807
    0.83340293]
  [ 0.4238999  -0.93465495 -0.6788466  ... -0.70717376 -0.54580367
   -0.7091748 ]
  [ 0.8732324  -0.40647054  0.43248215 ... -0.93245775 -0.97102326
   -0.96866757]]

 ...

 [[-0.56910884 -0.8330484   0.02021113 ...  0.5489578  -0.610262
    0.02895997]
  [ 0.17689787  0.7623353   0.22325061 ... -0.37297392  0.11547698
   -1.7152896 ]
  [-0.57397854 -0.5166516   0.5577154  ... -0.38235292  0.37549224
   -1.1695306 ]
  [ 0.22580376  0.8061789  -0.45837384 ... -0.00269647  0.295746
    0.14916852]
  [ 0.47981435  0.97546184  0.16085397 ...  0.6197122  -0.3784683
    0.11502245]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.69825006  0.24524824 -0.08116846 ...  0.35309932  0.3790157
   -0.17479652]
  [ 1.0504539   0.01408027 -0.36284605 ...  0.94061166  0.4027472
   -1.4641038 ]
  [ 0.0370342  -0.40037158  0.47134918 ...  0.9567943  -0.6239751
   -0.6511858 ]
  [ 0.3354941   0.22414632 -0.9450763  ... -0.0626528  -0.41902953
   -0.45009214]
  [ 0.01771878 -0.40333623 -0.5296116  ... -0.28148016  0.92548627
   -0.9823095 ]]]
Task 1, Epoch 4/5, Self_training_Iteration: 1 => Loss inf, Train_accy 38.50:  80%|████████████████████████████████████████████████████████████████████████                  | 4/5 [01:15<00:18, 18.78s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[ 1.3989958e-01  1.1333501e-01 -4.1593084e-01 ...  1.0251392e+00
   -4.3205690e-02 -3.1390959e-01]
  [-5.4242599e-01 -1.6151714e-01  1.5883262e-01 ...  2.4424277e-01
    8.1454474e-01 -3.8158771e-02]
  [-9.0897612e-02  5.4256326e-01 -6.0740823e-01 ...  2.1439780e-01
    2.9335281e-01  3.4870300e-01]
  [ 3.0254444e-01  7.1171701e-01  1.1815457e-01 ... -4.3232262e-02
   -4.2623617e-02  2.5554377e-01]
  [ 3.3339120e-02 -8.2240868e-01 -1.0255398e+00 ...  6.0666525e-01
   -2.6201543e-01 -1.6655593e-01]]

 [[-5.3983831e-01  5.3081703e-01 -4.6668527e-01 ... -8.1623924e-01
    1.9785982e-01 -1.0649114e-01]
  [ 1.7573522e-01 -9.1543216e-01 -7.6921605e-02 ...  7.9969746e-01
   -1.5806055e-01 -9.9095595e-01]
  [-4.9467662e-01 -4.7344438e-04 -1.0154229e+00 ... -7.7524662e-02
    4.9750876e-02  6.0179538e-01]
  [ 8.9956760e-02  1.3906670e-01  5.1483080e-02 ...  5.9490943e-01
   -8.9229155e-01 -9.3333828e-01]
  [ 5.7656187e-01 -1.4628598e-01 -4.5392521e-02 ...  7.1738482e-01
   -4.2473942e-01 -1.0221562e+00]]

 [[-2.0062131e-01 -2.5650100e-03  8.5689008e-01 ... -3.4775010e-01
   -1.0085363e+00  8.7428850e-01]
  [-4.7614220e-01  8.0802053e-01  3.8421884e-01 ...  9.3242228e-01
    3.1820917e-01  4.1629925e-02]
  [-6.2545413e-01 -2.2196475e-01 -3.0340576e-01 ...  7.3127639e-01
   -8.2678068e-01  8.3340293e-01]
  [ 4.2389989e-01 -9.3465495e-01 -6.7884660e-01 ... -7.0717376e-01
   -5.4580367e-01 -7.0917481e-01]
  [ 8.7323242e-01 -4.0647054e-01  4.3248215e-01 ... -9.3245775e-01
   -9.7102326e-01 -9.6866757e-01]]

 ...

 [[-7.1853554e-01 -6.6193980e-01  5.4784708e-02 ...  4.9691954e-01
   -6.5826088e-01 -8.8068649e-02]
  [ 6.1993401e-02  6.6932523e-01  2.5180173e-01 ... -4.1372472e-01
    1.0613826e-01 -1.6759435e+00]
  [-7.7033281e-01 -5.2183473e-01  5.5446744e-01 ... -2.3005696e-01
    2.5327954e-01 -1.3283490e+00]
  [ 2.5493428e-02  8.4457099e-01 -3.0895710e-01 ...  1.2603700e-01
    2.7789676e-01  6.4418383e-02]
  [ 5.8697182e-01  9.5209080e-01  5.6760861e-03 ...  7.4615312e-01
   -3.4982756e-01  9.6417561e-02]]

 [[-7.5741208e-01 -5.4697931e-01  2.0942450e-01 ... -5.7844841e-01
    7.3774993e-01  6.3170993e-01]
  [ 5.6927741e-01 -2.3225713e-01 -5.4914522e-01 ... -4.8301125e-01
   -2.7959323e-01 -7.2338915e-01]
  [-3.4088027e-01  6.3905120e-01  5.2556992e-01 ...  2.5032330e-01
    9.7615123e-02  6.7268848e-01]
  [-7.1048629e-01 -4.7325385e-01  6.7840970e-01 ...  7.9269052e-01
    4.5717835e-02  4.6423733e-01]
  [-8.4880126e-01  4.2689371e-01  6.6226137e-01 ... -5.4668033e-01
    4.2980576e-01  8.2954073e-01]]

 [[ 5.2848846e-01  2.8445873e-01  3.3180691e-02 ...  4.4681415e-01
    4.1044831e-01 -2.5307089e-01]
  [ 8.5556114e-01  2.3056615e-02 -3.5638487e-01 ...  8.8722587e-01
    4.9719906e-01 -1.4176594e+00]
  [ 5.4042753e-02 -3.8702354e-01  5.4497141e-01 ...  9.8674166e-01
   -5.2407628e-01 -7.5342846e-01]
  [ 2.0331876e-01  2.8936034e-01 -9.0553945e-01 ... -1.5306292e-01
   -3.3441755e-01 -5.7506657e-01]
  [ 1.6796229e-02 -2.9878944e-01 -1.8736759e-01 ... -2.6315042e-01
    8.6557686e-01 -8.7789452e-01]]]
tensor([8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8], device='cuda:5')
tensor([8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8], device='cuda:5')
tensor([8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8], device='cuda:5')
tensor([8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8], device='cuda:5')
tensor([8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8], device='cuda:5')
Task 1, Epoch 5/5, Self_training_Iteration: 1 => Loss inf, Train_accy 36.60, Test_accy 5.00: 100%|██████████████████████████████████████████████████████████████████████████| 5/5 [01:46<00:00, 21.22s/it]
2023-12-20 19:48:26,875 [l2p_self_training.py] => Task 1, Epoch 5/5, Self_training_Iteration: 1 => Loss inf, Train_accy 36.60, Test_accy 5.00
2023-12-20 19:48:26,876 [l2p_self_training.py] => Here are still 3003 unlabeled samples left
2023-12-20 19:48:26,877 [l2p_self_training.py] => pseudo labeling start
2023-12-20 19:48:45,010 [l2p_self_training.py] => 3002 unlabeled samples will be pseudo labeled
2023-12-20 19:48:45,011 [l2p_self_training.py] => pseudo labeling finish
Pseudo Accuracy:  0.0
  0%|                                                                                                                                                                               | 0/5 [00:00<?, ?it/s]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[-2.36718222e-01  8.26911107e-02 -3.01680982e-01 ...  9.31590617e-01
   -5.68064488e-02 -3.52573305e-01]
  [-5.59849441e-01 -3.37799042e-02  3.04105669e-01 ...  7.66985416e-01
    6.79923415e-01  1.41663194e-01]
  [-3.10347229e-01  3.70787024e-01 -1.16391964e-01 ...  6.77872598e-01
    2.93953065e-02 -1.37027428e-02]
  [ 1.04859799e-01  9.88788605e-01  3.68958354e-01 ...  8.06138590e-02
   -3.99273522e-02  2.46411785e-01]
  [-2.97901809e-01 -5.36524057e-01 -6.87310338e-01 ...  8.82903993e-01
   -2.06852034e-01 -4.36205795e-04]]

 [[-4.10631746e-01  4.90835905e-01 -6.86832011e-01 ... -9.00195658e-01
    1.84554875e-01 -3.68575960e-01]
  [-5.60158491e-01 -9.20353055e-01  1.41738310e-01 ...  9.68082130e-01
   -2.53885835e-01 -8.86705935e-01]
  [-7.28726745e-01  2.60519516e-02 -6.81747615e-01 ...  3.90475601e-01
   -6.96877688e-02  6.00333989e-01]
  [-4.28708732e-01  2.44628415e-01  1.88633159e-01 ...  6.66916609e-01
   -9.13122714e-01 -1.01876974e+00]
  [ 2.09401742e-01  2.82619763e-02  2.99436569e-01 ...  1.03188288e+00
   -7.80225039e-01 -9.57941413e-01]]

 [[-2.00621307e-01 -2.56500999e-03  8.56890082e-01 ... -3.47750098e-01
   -1.00853634e+00  8.74288499e-01]
  [-4.76142198e-01  8.08020532e-01  3.84218842e-01 ...  9.32422280e-01
    3.18209171e-01  4.16299254e-02]
  [-6.25454128e-01 -2.21964747e-01 -3.03405762e-01 ...  7.31276393e-01
   -8.26780677e-01  8.33402932e-01]
  [ 4.23899889e-01 -9.34654951e-01 -6.78846598e-01 ... -7.07173765e-01
   -5.45803666e-01 -7.09174812e-01]
  [ 8.73232424e-01 -4.06470537e-01  4.32482153e-01 ... -9.32457745e-01
   -9.71023262e-01 -9.68667567e-01]]

 ...

 [[-7.96445668e-01 -2.23197132e-01  6.59339428e-02 ...  6.67522132e-01
   -6.36570692e-01 -5.60111642e-01]
  [-6.54262155e-02  5.01966834e-01  2.03225762e-01 ... -5.09781241e-01
    2.28214592e-01 -1.52807868e+00]
  [-1.10505676e+00 -4.61294800e-01  3.08924109e-01 ...  1.40984654e-01
    2.91953206e-01 -1.56057477e+00]
  [-2.56801307e-01  8.43049467e-01  4.41637561e-02 ...  6.37312829e-01
    2.07353160e-01  2.45802710e-03]
  [ 7.27627218e-01  6.89842343e-01 -1.89358741e-01 ...  9.92679238e-01
   -3.42887938e-01  1.56571224e-01]]

 [[-7.57412076e-01 -5.46979308e-01  2.09424496e-01 ... -5.78448415e-01
    7.37749934e-01  6.31709933e-01]
  [ 5.69277406e-01 -2.32257128e-01 -5.49145222e-01 ... -4.83011246e-01
   -2.79593229e-01 -7.23389149e-01]
  [-3.40880275e-01  6.39051199e-01  5.25569916e-01 ...  2.50323296e-01
    9.76151228e-02  6.72688484e-01]
  [-7.10486293e-01 -4.73253846e-01  6.78409696e-01 ...  7.92690516e-01
    4.57178354e-02  4.64237332e-01]
  [-8.48801255e-01  4.26893711e-01  6.62261367e-01 ... -5.46680331e-01
    4.29805756e-01  8.29540730e-01]]

 [[ 3.22354078e-01  2.68236846e-01  4.38248932e-01 ...  8.11508000e-01
    3.60194504e-01 -4.08208251e-01]
  [ 5.42724490e-01  5.36306016e-03  1.85025573e-01 ...  4.97316778e-01
    5.12987018e-01 -1.27108741e+00]
  [-1.41644450e-02 -4.11876023e-01  5.43078125e-01 ...  9.60261762e-01
   -2.81725347e-01 -9.19787407e-01]
  [ 3.19534279e-02  2.73305684e-01 -4.35930699e-01 ... -3.75116952e-02
   -1.92632318e-01 -6.88350976e-01]
  [-2.61142164e-01 -7.04843551e-02  4.44425136e-01 ... -7.61312097e-02
    9.03660297e-01 -7.19418228e-01]]]
Task 1, Epoch 1/5, Self_training_Iteration: 2 => Loss inf, Train_accy 12.61:  20%|██████████████████                                                                        | 1/5 [00:46<03:04, 46.24s/it]Parameters of prompt: 
prompt.prompt torch.Size([10, 5, 768]) [[[-0.2284352   0.03028168 -0.16847919 ...  0.9671864  -0.04342839
   -0.54425216]
  [-0.6360575  -0.02981063  0.5950083  ...  0.86179227  0.56398624
    0.2647009 ]
  [-0.31534585  0.37066492 -0.09891641 ...  0.69490397  0.06543861
   -0.14385311]
  [ 0.17606416  1.0306033   0.43595544 ...  0.11132246  0.00850662
    0.23912641]
  [-0.5319907  -0.45483297 -0.4208173  ...  0.8681862  -0.099962
   -0.03473937]]

 [[-0.2664718   0.46302667 -0.65550107 ... -0.7994128   0.14961977
   -0.5344905 ]
  [-0.7863541  -0.96679515  0.211946   ...  1.0253469  -0.2850423
   -0.90290207]
  [-0.7696181   0.00302331 -0.38659728 ...  0.6425325  -0.09554341
    0.4629927 ]
  [-0.67337364  0.2969245   0.2263037  ...  0.7684932  -0.8788072
   -1.2100009 ]
  [ 0.323379    0.10370155  0.3523098  ...  1.1075195  -0.7478583
   -1.0523477 ]]

 [[-0.2006213  -0.00256501  0.8568901  ... -0.3477501  -1.0085363
    0.8742885 ]
  [-0.4761422   0.80802053  0.38421884 ...  0.9324223   0.31820917
    0.04162993]
  [-0.6254541  -0.22196475 -0.30340576 ...  0.7312764  -0.8267807
    0.83340293]
  [ 0.4238999  -0.93465495 -0.6788466  ... -0.70717376 -0.54580367
   -0.7091748 ]
  [ 0.8732324  -0.40647054  0.43248215 ... -0.93245775 -0.97102326
   -0.96866757]]

 ...

 [[-0.65191    -0.10340122  0.00439269 ...  0.7395333  -0.57162195
   -0.85244435]
  [-0.16425425  0.5221299   0.1355217  ... -0.45101213  0.25490445
   -1.5858737 ]
  [-1.116507   -0.48293895  0.28164348 ...  0.30581126  0.38106912
   -1.6338744 ]
  [-0.32654387  0.7649012   0.10484216 ...  0.94748485  0.12701675
   -0.02396668]
  [ 0.67122495  0.47695258 -0.3405693  ...  0.92322874 -0.24180803
    0.0452605 ]]

 [[-0.7574121  -0.5469793   0.2094245  ... -0.5784484   0.73774993
    0.63170993]
  [ 0.5692774  -0.23225713 -0.5491452  ... -0.48301125 -0.27959323
   -0.72338915]
  [-0.34088027  0.6390512   0.5255699  ...  0.2503233   0.09761512
    0.6726885 ]
  [-0.7104863  -0.47325385  0.6784097  ...  0.7926905   0.04571784
    0.46423733]
  [-0.84880126  0.4268937   0.66226137 ... -0.54668033  0.42980576
    0.8295407 ]]

 [[ 0.28663778  0.28515035  0.4959766  ...  0.9602101   0.35333884
   -0.41711107]
  [ 0.5358565   0.03765341  0.42714474 ...  0.3225715   0.4237351
   -1.3296953 ]
  [ 0.0578214  -0.31603414  0.6013745  ...  0.92110187 -0.11731028
   -1.0378158 ]
  [-0.01333617  0.06259289 -0.2780433  ...  0.18174286 -0.21742734
   -0.6956866 ]
  [-0.25581157  0.03027043  0.6130139  ... -0.08180183  0.997896
   -0.64631253]]]
Task 1, Epoch 2/5, Self_training_Iteration: 2 => Loss inf, Train_accy 8.82:  40%|████████████████████████████████████▍                                                      | 2/5 [01:32<02:18, 46.25s/it]Task 1, Epoch 2/5, Self_training_Iteration: 2 => Loss inf, Train_accy 8.82:  40%|████████████████████████████████████▍                                                      | 2/5 [01:49<02:44, 54.88s/it]